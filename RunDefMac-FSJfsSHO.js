var Ti=Object.defineProperty;var Bi=(S,r,t)=>r in S?Ti(S,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):S[r]=t;var oi=(S,r,t)=>(Bi(S,typeof r!="symbol"?r+"":r,t),t),Ur=(S,r,t)=>{if(!r.has(S))throw TypeError("Cannot "+t)};var b=(S,r,t)=>(Ur(S,r,"read from private field"),t?t.call(S):r.get(S)),K=(S,r,t)=>{if(r.has(S))throw TypeError("Cannot add the same private member more than once");r instanceof WeakSet?r.add(S):r.set(S,t)},q=(S,r,t,f)=>(Ur(S,r,"write to private field"),f?f.call(S,t):r.set(S,t),t);var ht=(S,r,t)=>(Ur(S,r,"access private method"),t);import{u as Fi,L as Cr,I as li,c as Pt,g as Li,i as Qt,e as Ni,E as Pi,a as jr,b as Ui,d as ji,f as ci,h as Wi,j as wi,k as yi,l as vi,m as Hi,n as Ki,o as Zi,P as Gi,p as Vi,q as Yi,r as ot,s as he,t as H,v as Xi,B as ue,w as bi,D as Lr,x as Qi,y as si,C as ui,z as qi,S as hi,A as Ji,F as $i,G as tn,H as en,J as kr,K as Kr,M as rn,N as nn,O as sn,Q as De,R as an,T as on,U as ln,V as cn,W as un}from"./index-CdMQsj-y.js";const hn="/assets/minivmac-128K--drHPBu3.wasm",dn="/assets/minivmac-512Ke-BxAX5jJt.wasm",fn="/assets/minivmac-II-DI-P0fVc.wasm",pn="/assets/minivmac-Plus-BUAVpPQO.wasm",mn="/assets/minivmac-SE-DzZrhYuI.wasm",gn="/assets/BasiliskII-DCcDx7pJ.wasm",_n="/assets/SheepShaver-CQPBdQGu.wasm",wn="/assets/dingusppc-DHErN5UV.wasm",yn="/assets/previous-BsuC0hUV.wasm";function vn(S){const{emulatorType:r,emulatorSubtype:t}=S;switch(r){case"BasiliskII":return gn;case"SheepShaver":return _n;case"Mini vMac":return{"128K":hn,"512Ke":dn,Plus:pn,SE:mn,II:fn}[t];case"DingusPPC":return wn;case"Previous":return yn}}function di(S){return new Worker("/assets/emulator-worker-CRW7lFSv.js",{type:"module",name:S==null?void 0:S.name})}const bn="/assets/emulator-service-worker-CA9h7in9.js",kn="/assets/emulator-audio-worklet-B3izXurZ.js";class ki{static getStorageForCapacity(r,t){if(!t.BYTES_PER_ELEMENT)throw"Pass in a ArrayBuffer subclass";var f=8+(r+1)*t.BYTES_PER_ELEMENT;return new SharedArrayBuffer(f)}constructor(r,t){if(!ArrayBuffer.__proto__.isPrototypeOf(t)&&t.BYTES_PER_ELEMENT!==void 0)throw"Pass a concrete typed array class as second argument";this._type=t,this._capacity=(r.byteLength-8)/t.BYTES_PER_ELEMENT,this.buf=r,this.write_ptr=new Uint32Array(this.buf,0,1),this.read_ptr=new Uint32Array(this.buf,4,1),this.storage=new t(this.buf,8,this._capacity)}type(){return this._type.name}push(r,t){var f=Atomics.load(this.read_ptr,0),u=Atomics.load(this.write_ptr,0);if((u+1)%this._storage_capacity()==f)return 0;var n=t??r.length;let s=Math.min(this._available_write(f,u),n),i=Math.min(this._storage_capacity()-u,s),o=s-i;return this._copy(r,0,this.storage,u,i),this._copy(r,i,this.storage,0,o),Atomics.store(this.write_ptr,0,(u+s)%this._storage_capacity()),s}writeCallback(r,t){var f=Atomics.load(this.read_ptr,0),u=Atomics.load(this.write_ptr,0);if((u+1)%this._storage_capacity()==f)return 0;let n=Math.min(this._available_write(f,u),r),s=Math.min(this._storage_capacity()-u,n),i=n-s;var o=new this._type(this.storage.buffer,8+u*4,s),h=new this._type(this.storage.buffer,8,i);return t(o,h),Atomics.store(this.write_ptr,0,(u+n)%this._storage_capacity()),n}pop(r,t){var f=Atomics.load(this.read_ptr,0),u=Atomics.load(this.write_ptr,0);if(u==f)return 0;var n=t??r.length;let s=Math.min(this._available_read(f,u),n),i=Math.min(this._storage_capacity()-f,s),o=s-i;return this._copy(this.storage,f,r,0,i),this._copy(this.storage,0,r,i,o),Atomics.store(this.read_ptr,0,(f+s)%this._storage_capacity()),s}empty(){var r=Atomics.load(this.read_ptr,0),t=Atomics.load(this.write_ptr,0);return t==r}full(){var r=Atomics.load(this.read_ptr,0),t=Atomics.load(this.write_ptr,0);return(t+1)%this._storage_capacity()==r}capacity(){return this._capacity-1}available_read(){var r=Atomics.load(this.read_ptr,0),t=Atomics.load(this.write_ptr,0);return this._available_read(r,t)}available_write(){var r=Atomics.load(this.read_ptr,0),t=Atomics.load(this.write_ptr,0);return this._available_write(r,t)}_available_read(r,t){return(t+this._storage_capacity()-r)%this._storage_capacity()}_available_write(r,t){return this.capacity()-this._available_read(r,t)}_storage_capacity(){return this._capacity}_copy(r,t,f,u,n){for(var s=0;s<n;s++)f[u+s]=r[t+s]}}var Re,It,de,qt,Oe,Zr,Dr,Ei;class Si{constructor(r){K(this,Oe);K(this,Dr);K(this,Re,void 0);K(this,It,void 0);K(this,de,void 0);oi(this,"emulatorPlaybackNode");K(this,qt,()=>{var r,t;(r=b(this,It))==null||r.resume(),(t=b(this,It))==null||t.addEventListener("statechange",()=>{var f;((f=b(this,It))==null?void 0:f.state)==="running"&&window.setTimeout(()=>ht(this,Oe,Zr).call(this),250)},{once:!0})});q(this,Re,r)}async init(r,t,f,u){if(typeof AudioContext>"u"){console.warn("AudioContext not supported");return}let n="Initializing";if(b(this,It)&&(n="Re-initializing",this.stop(),this.resetAudioBuffer()),console.log(`${n} audio (sampleRate=${r}, sampleSize=${t}, channels=${f})`),q(this,It,new AudioContext({latencyHint:"interactive",sampleRate:r})),!b(this,It).audioWorklet||typeof AudioWorkletNode>"u"){console.warn("AudioWorklet not supported");return}await b(this,It).audioWorklet.addModule(kn),this.emulatorPlaybackNode=new AudioWorkletNode(b(this,It),"emulator-playback-processor",{numberOfInputs:0,numberOfOutputs:1,outputChannelCount:[f],channelCount:f,processorOptions:{sampleSize:t,debug:u,config:this.workerConfig()}}),this.emulatorPlaybackNode.connect(b(this,It).destination),b(this,It).state==="suspended"?(window.addEventListener("mousedown",b(this,qt),{once:!0}),window.addEventListener("touchstart",b(this,qt),{once:!0})):ht(this,Oe,Zr).call(this),u&&q(this,de,window.setInterval(()=>ht(this,Dr,Ei).call(this,r,t,f),100))}stop(){var r;(r=b(this,It))==null||r.close(),window.removeEventListener("mousedown",b(this,qt)),window.removeEventListener("touchstart",b(this,qt)),b(this,de)&&window.clearInterval(b(this,de))}}Re=new WeakMap,It=new WeakMap,de=new WeakMap,qt=new WeakMap,Oe=new WeakSet,Zr=function(){this.resetAudioBuffer(),b(this,Re).handleInput({type:"audio-context-running"})},Dr=new WeakSet,Ei=function(r,t,f){const u=this.currentAudioBufferByteLength();if(u===0)return;const n=u/(t>>3)/f,s=n/r*1e3;console.log("audio buffer:",(u/Ci*100).toFixed(1)+"% full - ",u,"bytes - ",n,"samples - ",s.toFixed(1),"ms")};const Ci=2*22050;var Me,fe;class Sn extends Si{constructor(){super(...arguments);K(this,Me,new SharedArrayBuffer(Ci));K(this,fe,new ki(b(this,Me),Uint8Array))}workerConfig(){return{type:"shared-memory",audioBuffer:b(this,Me)}}resetAudioBuffer(){const t=new Uint8Array(b(this,fe).available_read());b(this,fe).pop(t)}currentAudioBufferByteLength(){return b(this,fe).available_read()}}Me=new WeakMap,fe=new WeakMap;class fi extends Si{workerConfig(){return{type:"fallback"}}handleData(r){var t;(t=this.emulatorPlaybackNode)==null||t.port.postMessage({type:"data",data:r})}resetAudioBuffer(){var r;(r=this.emulatorPlaybackNode)==null||r.port.postMessage({type:"reset"})}currentAudioBufferByteLength(){return 0}}const Gr=100;var ze,pe,Wt,Te,Vr,Be,Yr,Ir,Ai,Rr,xi;class En{constructor(){K(this,Te);K(this,Be);K(this,Ir);K(this,Rr);K(this,ze,new SharedArrayBuffer(Gr*4));K(this,pe,new Int32Array(b(this,ze)));K(this,Wt,[])}workerConfig(){return{type:"shared-memory",inputBuffer:b(this,ze),inputBufferSize:Gr}}handleInput(r){b(this,Wt).push(r),ht(this,Te,Vr).call(this)}}ze=new WeakMap,pe=new WeakMap,Wt=new WeakMap,Te=new WeakSet,Vr=function(){if(b(this,Wt).length){if(!ht(this,Ir,Ai).call(this)){ht(this,Be,Yr).call(this);return}q(this,Wt,Fi(b(this,Wt),b(this,pe))),ht(this,Rr,xi).call(this),b(this,Wt).length&&ht(this,Be,Yr).call(this)}},Be=new WeakSet,Yr=function(){window.setTimeout(()=>ht(this,Te,Vr).call(this),0)},Ir=new WeakSet,Ai=function(){return Cn(b(this,pe),li.globalLockAddr)},Rr=new WeakSet,xi=function(){An(b(this,pe),li.globalLockAddr)};function Cn(S,r){return Atomics.compareExchange(S,r,Cr.READY_FOR_UI_THREAD,Cr.UI_THREAD_LOCK)===Cr.READY_FOR_UI_THREAD}function An(S,r){Atomics.store(S,r,Cr.READY_FOR_EMUL_THREAD),Atomics.notify(S,r)}var Fe;class xn{constructor(r){K(this,Fe,void 0);q(this,Fe,r)}workerConfig(){return{type:"fallback",inputBufferSize:Gr}}handleInput(r){b(this,Fe).call(this,{type:"input",event:r})}}Fe=new WeakMap;const pi=10;var me,Jt,Le,Ne,Or,Ht;class Dn{constructor(r){K(this,me,void 0);K(this,Jt,void 0);K(this,Le,void 0);K(this,Ne,new SharedArrayBuffer(pi*4));K(this,Or,new Int32Array(b(this,Ne)));K(this,Ht,void 0);q(this,me,r);const t=r.screenWidth*r.screenHeight*4;q(this,Jt,new SharedArrayBuffer(t)),q(this,Le,new Uint8Array(b(this,Jt)))}workerConfig(){return{type:"shared-memory",screenBuffer:b(this,Jt),screenBufferSize:b(this,Jt).byteLength,videoModeBuffer:b(this,Ne),videoModeBufferSize:pi,screenWidth:b(this,me).screenWidth,screenHeight:b(this,me).screenHeight}}blit(r){const{rect:t}=r;t&&(b(this,Ht)?Di(b(this,Ht),t):q(this,Ht,t))}imageData(){const r=b(this,Or)[0];return b(this,Le).subarray(0,r)}consumeBlitRect(){const r=b(this,Ht);return q(this,Ht,void 0),r}}me=new WeakMap,Jt=new WeakMap,Le=new WeakMap,Ne=new WeakMap,Or=new WeakMap,Ht=new WeakMap;var Mr,Pe,Kt;class In{constructor(r){K(this,Mr,void 0);K(this,Pe,void 0);K(this,Kt,void 0);q(this,Mr,r)}workerConfig(){return{type:"fallback"}}blit(r){if(r.type!=="fallback")return;q(this,Pe,r);const{rect:t}=r;t&&(b(this,Kt)?Di(b(this,Kt),t):q(this,Kt,t))}imageData(){var r;return(r=b(this,Pe))==null?void 0:r.data}consumeBlitRect(){const r=b(this,Kt);return q(this,Kt,void 0),r}}Mr=new WeakMap,Pe=new WeakMap,Kt=new WeakMap;function Di(S,r){S.top=Math.min(S.top,r.top),S.left=Math.min(S.left,r.left),S.bottom=Math.max(S.bottom,r.bottom),S.right=Math.max(S.right,r.right)}const Wr=1024*1024;var $t,Ue,je,ge,Ar;class Rn{constructor(){K(this,ge);K(this,$t,{uploads:[],cdroms:[]});K(this,Ue,new SharedArrayBuffer(Wr));K(this,je,new Uint8Array(b(this,Ue)));ht(this,ge,Ar).call(this)}workerConfig(){return{type:"shared-memory",filesBuffer:b(this,Ue),filesBufferSize:Wr}}uploadFile(r){this.uploadFiles([r])}uploadFiles(r){b(this,$t).uploads.push(...r),ht(this,ge,Ar).call(this)}loadCDROM(r){b(this,$t).cdroms.push(r),ht(this,ge,Ar).call(this)}}$t=new WeakMap,Ue=new WeakMap,je=new WeakMap,ge=new WeakSet,Ar=function(){const r=JSON.stringify(b(this,$t));q(this,$t,{uploads:[],cdroms:[]});const t=new TextEncoder().encode(r);if(t.length>Wr){console.warn("Files actions is too large, dropping");return}b(this,je).set(t),b(this,je).set([0],t.length)};var _e;class On{constructor(r){K(this,_e,void 0);q(this,_e,r)}workerConfig(){return{type:"fallback"}}uploadFile(r){b(this,_e).call(this,{type:"upload_file",upload:r})}uploadFiles(r){for(const t of r)this.uploadFile(t)}loadCDROM(r){b(this,_e).call(this,{type:"load_cdrom",cdrom:r})}}_e=new WeakMap;function Sr(S){throw new Error('Could not dynamically require "'+S+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ii={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(S,r){(function(t){S.exports=t()})(function(){return function t(f,u,n){function s(h,m){if(!u[h]){if(!f[h]){var y=typeof Sr=="function"&&Sr;if(!m&&y)return y(h,!0);if(i)return i(h,!0);var _=new Error("Cannot find module '"+h+"'");throw _.code="MODULE_NOT_FOUND",_}var c=u[h]={exports:{}};f[h][0].call(c.exports,function(g){var l=f[h][1][g];return s(l||g)},c,c.exports,t,f,u,n)}return u[h].exports}for(var i=typeof Sr=="function"&&Sr,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(t,f,u){var n=t("./utils"),s=t("./support"),i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";u.encode=function(o){for(var h,m,y,_,c,g,l,p=[],d=0,k=o.length,C=k,x=n.getTypeOf(o)!=="string";d<o.length;)C=k-d,y=x?(h=o[d++],m=d<k?o[d++]:0,d<k?o[d++]:0):(h=o.charCodeAt(d++),m=d<k?o.charCodeAt(d++):0,d<k?o.charCodeAt(d++):0),_=h>>2,c=(3&h)<<4|m>>4,g=1<C?(15&m)<<2|y>>6:64,l=2<C?63&y:64,p.push(i.charAt(_)+i.charAt(c)+i.charAt(g)+i.charAt(l));return p.join("")},u.decode=function(o){var h,m,y,_,c,g,l=0,p=0,d="data:";if(o.substr(0,d.length)===d)throw new Error("Invalid base64 input, it looks like a data url.");var k,C=3*(o=o.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(o.charAt(o.length-1)===i.charAt(64)&&C--,o.charAt(o.length-2)===i.charAt(64)&&C--,C%1!=0)throw new Error("Invalid base64 input, bad content length.");for(k=s.uint8array?new Uint8Array(0|C):new Array(0|C);l<o.length;)h=i.indexOf(o.charAt(l++))<<2|(_=i.indexOf(o.charAt(l++)))>>4,m=(15&_)<<4|(c=i.indexOf(o.charAt(l++)))>>2,y=(3&c)<<6|(g=i.indexOf(o.charAt(l++))),k[p++]=h,c!==64&&(k[p++]=m),g!==64&&(k[p++]=y);return k}},{"./support":30,"./utils":32}],2:[function(t,f,u){var n=t("./external"),s=t("./stream/DataWorker"),i=t("./stream/Crc32Probe"),o=t("./stream/DataLengthProbe");function h(m,y,_,c,g){this.compressedSize=m,this.uncompressedSize=y,this.crc32=_,this.compression=c,this.compressedContent=g}h.prototype={getContentWorker:function(){var m=new s(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),y=this;return m.on("end",function(){if(this.streamInfo.data_length!==y.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),m},getCompressedWorker:function(){return new s(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},h.createWorkerFrom=function(m,y,_){return m.pipe(new i).pipe(new o("uncompressedSize")).pipe(y.compressWorker(_)).pipe(new o("compressedSize")).withStreamInfo("compression",y)},f.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,f,u){var n=t("./stream/GenericWorker");u.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},u.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,f,u){var n=t("./utils"),s=function(){for(var i,o=[],h=0;h<256;h++){i=h;for(var m=0;m<8;m++)i=1&i?3988292384^i>>>1:i>>>1;o[h]=i}return o}();f.exports=function(i,o){return i!==void 0&&i.length?n.getTypeOf(i)!=="string"?function(h,m,y,_){var c=s,g=_+y;h^=-1;for(var l=_;l<g;l++)h=h>>>8^c[255&(h^m[l])];return-1^h}(0|o,i,i.length,0):function(h,m,y,_){var c=s,g=_+y;h^=-1;for(var l=_;l<g;l++)h=h>>>8^c[255&(h^m.charCodeAt(l))];return-1^h}(0|o,i,i.length,0):0}},{"./utils":32}],5:[function(t,f,u){u.base64=!1,u.binary=!1,u.dir=!1,u.createFolders=!0,u.date=null,u.compression=null,u.compressionOptions=null,u.comment=null,u.unixPermissions=null,u.dosPermissions=null},{}],6:[function(t,f,u){var n=null;n=typeof Promise<"u"?Promise:t("lie"),f.exports={Promise:n}},{lie:37}],7:[function(t,f,u){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=t("pako"),i=t("./utils"),o=t("./stream/GenericWorker"),h=n?"uint8array":"array";function m(y,_){o.call(this,"FlateWorker/"+y),this._pako=null,this._pakoAction=y,this._pakoOptions=_,this.meta={}}u.magic="\b\0",i.inherits(m,o),m.prototype.processChunk=function(y){this.meta=y.meta,this._pako===null&&this._createPako(),this._pako.push(i.transformTo(h,y.data),!1)},m.prototype.flush=function(){o.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},m.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},m.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var y=this;this._pako.onData=function(_){y.push({data:_,meta:y.meta})}},u.compressWorker=function(y){return new m("Deflate",y)},u.uncompressWorker=function(){return new m("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,f,u){function n(c,g){var l,p="";for(l=0;l<g;l++)p+=String.fromCharCode(255&c),c>>>=8;return p}function s(c,g,l,p,d,k){var C,x,D=c.file,L=c.compression,T=k!==h.utf8encode,j=i.transformTo("string",k(D.name)),z=i.transformTo("string",h.utf8encode(D.name)),Y=D.comment,rt=i.transformTo("string",k(Y)),E=i.transformTo("string",h.utf8encode(Y)),B=z.length!==D.name.length,a=E.length!==Y.length,N="",nt="",Z="",st=D.dir,U=D.date,it={crc32:0,compressedSize:0,uncompressedSize:0};g&&!l||(it.crc32=c.crc32,it.compressedSize=c.compressedSize,it.uncompressedSize=c.uncompressedSize);var O=0;g&&(O|=8),T||!B&&!a||(O|=2048);var R=0,et=0;st&&(R|=16),d==="UNIX"?(et=798,R|=function(X,gt){var vt=X;return X||(vt=gt?16893:33204),(65535&vt)<<16}(D.unixPermissions,st)):(et=20,R|=function(X){return 63&(X||0)}(D.dosPermissions)),C=U.getUTCHours(),C<<=6,C|=U.getUTCMinutes(),C<<=5,C|=U.getUTCSeconds()/2,x=U.getUTCFullYear()-1980,x<<=4,x|=U.getUTCMonth()+1,x<<=5,x|=U.getUTCDate(),B&&(nt=n(1,1)+n(m(j),4)+z,N+="up"+n(nt.length,2)+nt),a&&(Z=n(1,1)+n(m(rt),4)+E,N+="uc"+n(Z.length,2)+Z);var Q="";return Q+=`
\0`,Q+=n(O,2),Q+=L.magic,Q+=n(C,2),Q+=n(x,2),Q+=n(it.crc32,4),Q+=n(it.compressedSize,4),Q+=n(it.uncompressedSize,4),Q+=n(j.length,2),Q+=n(N.length,2),{fileRecord:y.LOCAL_FILE_HEADER+Q+j+N,dirRecord:y.CENTRAL_FILE_HEADER+n(et,2)+Q+n(rt.length,2)+"\0\0\0\0"+n(R,4)+n(p,4)+j+N+rt}}var i=t("../utils"),o=t("../stream/GenericWorker"),h=t("../utf8"),m=t("../crc32"),y=t("../signature");function _(c,g,l,p){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=g,this.zipPlatform=l,this.encodeFileName=p,this.streamFiles=c,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}i.inherits(_,o),_.prototype.push=function(c){var g=c.meta.percent||0,l=this.entriesCount,p=this._sources.length;this.accumulate?this.contentBuffer.push(c):(this.bytesWritten+=c.data.length,o.prototype.push.call(this,{data:c.data,meta:{currentFile:this.currentFile,percent:l?(g+100*(l-p-1))/l:100}}))},_.prototype.openedSource=function(c){this.currentSourceOffset=this.bytesWritten,this.currentFile=c.file.name;var g=this.streamFiles&&!c.file.dir;if(g){var l=s(c,g,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:l.fileRecord,meta:{percent:0}})}else this.accumulate=!0},_.prototype.closedSource=function(c){this.accumulate=!1;var g=this.streamFiles&&!c.file.dir,l=s(c,g,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(l.dirRecord),g)this.push({data:function(p){return y.DATA_DESCRIPTOR+n(p.crc32,4)+n(p.compressedSize,4)+n(p.uncompressedSize,4)}(c),meta:{percent:100}});else for(this.push({data:l.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},_.prototype.flush=function(){for(var c=this.bytesWritten,g=0;g<this.dirRecords.length;g++)this.push({data:this.dirRecords[g],meta:{percent:100}});var l=this.bytesWritten-c,p=function(d,k,C,x,D){var L=i.transformTo("string",D(x));return y.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(d,2)+n(d,2)+n(k,4)+n(C,4)+n(L.length,2)+L}(this.dirRecords.length,l,c,this.zipComment,this.encodeFileName);this.push({data:p,meta:{percent:100}})},_.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},_.prototype.registerPrevious=function(c){this._sources.push(c);var g=this;return c.on("data",function(l){g.processChunk(l)}),c.on("end",function(){g.closedSource(g.previous.streamInfo),g._sources.length?g.prepareNextSource():g.end()}),c.on("error",function(l){g.error(l)}),this},_.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},_.prototype.error=function(c){var g=this._sources;if(!o.prototype.error.call(this,c))return!1;for(var l=0;l<g.length;l++)try{g[l].error(c)}catch{}return!0},_.prototype.lock=function(){o.prototype.lock.call(this);for(var c=this._sources,g=0;g<c.length;g++)c[g].lock()},f.exports=_},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,f,u){var n=t("../compressions"),s=t("./ZipFileWorker");u.generateWorker=function(i,o,h){var m=new s(o.streamFiles,h,o.platform,o.encodeFileName),y=0;try{i.forEach(function(_,c){y++;var g=function(k,C){var x=k||C,D=n[x];if(!D)throw new Error(x+" is not a valid compression method !");return D}(c.options.compression,o.compression),l=c.options.compressionOptions||o.compressionOptions||{},p=c.dir,d=c.date;c._compressWorker(g,l).withStreamInfo("file",{name:_,dir:p,date:d,comment:c.comment||"",unixPermissions:c.unixPermissions,dosPermissions:c.dosPermissions}).pipe(m)}),m.entriesCount=y}catch(_){m.error(_)}return m}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,f,u){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new n;for(var i in this)typeof this[i]!="function"&&(s[i]=this[i]);return s}}(n.prototype=t("./object")).loadAsync=t("./load"),n.support=t("./support"),n.defaults=t("./defaults"),n.version="3.10.1",n.loadAsync=function(s,i){return new n().loadAsync(s,i)},n.external=t("./external"),f.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,f,u){var n=t("./utils"),s=t("./external"),i=t("./utf8"),o=t("./zipEntries"),h=t("./stream/Crc32Probe"),m=t("./nodejsUtils");function y(_){return new s.Promise(function(c,g){var l=_.decompressed.getContentWorker().pipe(new h);l.on("error",function(p){g(p)}).on("end",function(){l.streamInfo.crc32!==_.decompressed.crc32?g(new Error("Corrupted zip : CRC32 mismatch")):c()}).resume()})}f.exports=function(_,c){var g=this;return c=n.extend(c||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:i.utf8decode}),m.isNode&&m.isStream(_)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",_,!0,c.optimizedBinaryString,c.base64).then(function(l){var p=new o(c);return p.load(l),p}).then(function(l){var p=[s.Promise.resolve(l)],d=l.files;if(c.checkCRC32)for(var k=0;k<d.length;k++)p.push(y(d[k]));return s.Promise.all(p)}).then(function(l){for(var p=l.shift(),d=p.files,k=0;k<d.length;k++){var C=d[k],x=C.fileNameStr,D=n.resolve(C.fileNameStr);g.file(D,C.decompressed,{binary:!0,optimizedBinaryString:!0,date:C.date,dir:C.dir,comment:C.fileCommentStr.length?C.fileCommentStr:null,unixPermissions:C.unixPermissions,dosPermissions:C.dosPermissions,createFolders:c.createFolders}),C.dir||(g.file(D).unsafeOriginalName=x)}return p.zipComment.length&&(g.comment=p.zipComment),g})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,f,u){var n=t("../utils"),s=t("../stream/GenericWorker");function i(o,h){s.call(this,"Nodejs stream input adapter for "+o),this._upstreamEnded=!1,this._bindStream(h)}n.inherits(i,s),i.prototype._bindStream=function(o){var h=this;(this._stream=o).pause(),o.on("data",function(m){h.push({data:m,meta:{percent:0}})}).on("error",function(m){h.isPaused?this.generatedError=m:h.error(m)}).on("end",function(){h.isPaused?h._upstreamEnded=!0:h.end()})},i.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},i.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},f.exports=i},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,f,u){var n=t("readable-stream").Readable;function s(i,o,h){n.call(this,o),this._helper=i;var m=this;i.on("data",function(y,_){m.push(y)||m._helper.pause(),h&&h(_)}).on("error",function(y){m.emit("error",y)}).on("end",function(){m.push(null)})}t("../utils").inherits(s,n),s.prototype._read=function(){this._helper.resume()},f.exports=s},{"../utils":32,"readable-stream":16}],14:[function(t,f,u){f.exports={isNode:typeof Buffer<"u",newBufferFrom:function(n,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(n,s);if(typeof n=="number")throw new Error('The "data" argument must not be a number');return new Buffer(n,s)},allocBuffer:function(n){if(Buffer.alloc)return Buffer.alloc(n);var s=new Buffer(n);return s.fill(0),s},isBuffer:function(n){return Buffer.isBuffer(n)},isStream:function(n){return n&&typeof n.on=="function"&&typeof n.pause=="function"&&typeof n.resume=="function"}}},{}],15:[function(t,f,u){function n(D,L,T){var j,z=i.getTypeOf(L),Y=i.extend(T||{},m);Y.date=Y.date||new Date,Y.compression!==null&&(Y.compression=Y.compression.toUpperCase()),typeof Y.unixPermissions=="string"&&(Y.unixPermissions=parseInt(Y.unixPermissions,8)),Y.unixPermissions&&16384&Y.unixPermissions&&(Y.dir=!0),Y.dosPermissions&&16&Y.dosPermissions&&(Y.dir=!0),Y.dir&&(D=d(D)),Y.createFolders&&(j=p(D))&&k.call(this,j,!0);var rt=z==="string"&&Y.binary===!1&&Y.base64===!1;T&&T.binary!==void 0||(Y.binary=!rt),(L instanceof y&&L.uncompressedSize===0||Y.dir||!L||L.length===0)&&(Y.base64=!1,Y.binary=!0,L="",Y.compression="STORE",z="string");var E=null;E=L instanceof y||L instanceof o?L:g.isNode&&g.isStream(L)?new l(D,L):i.prepareContent(D,L,Y.binary,Y.optimizedBinaryString,Y.base64);var B=new _(D,E,Y);this.files[D]=B}var s=t("./utf8"),i=t("./utils"),o=t("./stream/GenericWorker"),h=t("./stream/StreamHelper"),m=t("./defaults"),y=t("./compressedObject"),_=t("./zipObject"),c=t("./generate"),g=t("./nodejsUtils"),l=t("./nodejs/NodejsStreamInputAdapter"),p=function(D){D.slice(-1)==="/"&&(D=D.substring(0,D.length-1));var L=D.lastIndexOf("/");return 0<L?D.substring(0,L):""},d=function(D){return D.slice(-1)!=="/"&&(D+="/"),D},k=function(D,L){return L=L!==void 0?L:m.createFolders,D=d(D),this.files[D]||n.call(this,D,null,{dir:!0,createFolders:L}),this.files[D]};function C(D){return Object.prototype.toString.call(D)==="[object RegExp]"}var x={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(D){var L,T,j;for(L in this.files)j=this.files[L],(T=L.slice(this.root.length,L.length))&&L.slice(0,this.root.length)===this.root&&D(T,j)},filter:function(D){var L=[];return this.forEach(function(T,j){D(T,j)&&L.push(j)}),L},file:function(D,L,T){if(arguments.length!==1)return D=this.root+D,n.call(this,D,L,T),this;if(C(D)){var j=D;return this.filter(function(Y,rt){return!rt.dir&&j.test(Y)})}var z=this.files[this.root+D];return z&&!z.dir?z:null},folder:function(D){if(!D)return this;if(C(D))return this.filter(function(z,Y){return Y.dir&&D.test(z)});var L=this.root+D,T=k.call(this,L),j=this.clone();return j.root=T.name,j},remove:function(D){D=this.root+D;var L=this.files[D];if(L||(D.slice(-1)!=="/"&&(D+="/"),L=this.files[D]),L&&!L.dir)delete this.files[D];else for(var T=this.filter(function(z,Y){return Y.name.slice(0,D.length)===D}),j=0;j<T.length;j++)delete this.files[T[j].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(D){var L,T={};try{if((T=i.extend(D||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=T.type.toLowerCase(),T.compression=T.compression.toUpperCase(),T.type==="binarystring"&&(T.type="string"),!T.type)throw new Error("No output type specified.");i.checkSupport(T.type),T.platform!=="darwin"&&T.platform!=="freebsd"&&T.platform!=="linux"&&T.platform!=="sunos"||(T.platform="UNIX"),T.platform==="win32"&&(T.platform="DOS");var j=T.comment||this.comment||"";L=c.generateWorker(this,T,j)}catch(z){(L=new o("error")).error(z)}return new h(L,T.type||"string",T.mimeType)},generateAsync:function(D,L){return this.generateInternalStream(D).accumulate(L)},generateNodeStream:function(D,L){return(D=D||{}).type||(D.type="nodebuffer"),this.generateInternalStream(D).toNodejsStream(L)}};f.exports=x},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,f,u){f.exports=t("stream")},{stream:void 0}],17:[function(t,f,u){var n=t("./DataReader");function s(i){n.call(this,i);for(var o=0;o<this.data.length;o++)i[o]=255&i[o]}t("../utils").inherits(s,n),s.prototype.byteAt=function(i){return this.data[this.zero+i]},s.prototype.lastIndexOfSignature=function(i){for(var o=i.charCodeAt(0),h=i.charCodeAt(1),m=i.charCodeAt(2),y=i.charCodeAt(3),_=this.length-4;0<=_;--_)if(this.data[_]===o&&this.data[_+1]===h&&this.data[_+2]===m&&this.data[_+3]===y)return _-this.zero;return-1},s.prototype.readAndCheckSignature=function(i){var o=i.charCodeAt(0),h=i.charCodeAt(1),m=i.charCodeAt(2),y=i.charCodeAt(3),_=this.readData(4);return o===_[0]&&h===_[1]&&m===_[2]&&y===_[3]},s.prototype.readData=function(i){if(this.checkOffset(i),i===0)return[];var o=this.data.slice(this.zero+this.index,this.zero+this.index+i);return this.index+=i,o},f.exports=s},{"../utils":32,"./DataReader":18}],18:[function(t,f,u){var n=t("../utils");function s(i){this.data=i,this.length=i.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(i){this.checkIndex(this.index+i)},checkIndex:function(i){if(this.length<this.zero+i||i<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+i+"). Corrupted zip ?")},setIndex:function(i){this.checkIndex(i),this.index=i},skip:function(i){this.setIndex(this.index+i)},byteAt:function(){},readInt:function(i){var o,h=0;for(this.checkOffset(i),o=this.index+i-1;o>=this.index;o--)h=(h<<8)+this.byteAt(o);return this.index+=i,h},readString:function(i){return n.transformTo("string",this.readData(i))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var i=this.readInt(4);return new Date(Date.UTC(1980+(i>>25&127),(i>>21&15)-1,i>>16&31,i>>11&31,i>>5&63,(31&i)<<1))}},f.exports=s},{"../utils":32}],19:[function(t,f,u){var n=t("./Uint8ArrayReader");function s(i){n.call(this,i)}t("../utils").inherits(s,n),s.prototype.readData=function(i){this.checkOffset(i);var o=this.data.slice(this.zero+this.index,this.zero+this.index+i);return this.index+=i,o},f.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,f,u){var n=t("./DataReader");function s(i){n.call(this,i)}t("../utils").inherits(s,n),s.prototype.byteAt=function(i){return this.data.charCodeAt(this.zero+i)},s.prototype.lastIndexOfSignature=function(i){return this.data.lastIndexOf(i)-this.zero},s.prototype.readAndCheckSignature=function(i){return i===this.readData(4)},s.prototype.readData=function(i){this.checkOffset(i);var o=this.data.slice(this.zero+this.index,this.zero+this.index+i);return this.index+=i,o},f.exports=s},{"../utils":32,"./DataReader":18}],21:[function(t,f,u){var n=t("./ArrayReader");function s(i){n.call(this,i)}t("../utils").inherits(s,n),s.prototype.readData=function(i){if(this.checkOffset(i),i===0)return new Uint8Array(0);var o=this.data.subarray(this.zero+this.index,this.zero+this.index+i);return this.index+=i,o},f.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(t,f,u){var n=t("../utils"),s=t("../support"),i=t("./ArrayReader"),o=t("./StringReader"),h=t("./NodeBufferReader"),m=t("./Uint8ArrayReader");f.exports=function(y){var _=n.getTypeOf(y);return n.checkSupport(_),_!=="string"||s.uint8array?_==="nodebuffer"?new h(y):s.uint8array?new m(n.transformTo("uint8array",y)):new i(n.transformTo("array",y)):new o(y)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,f,u){u.LOCAL_FILE_HEADER="PK",u.CENTRAL_FILE_HEADER="PK",u.CENTRAL_DIRECTORY_END="PK",u.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",u.ZIP64_CENTRAL_DIRECTORY_END="PK",u.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,f,u){var n=t("./GenericWorker"),s=t("../utils");function i(o){n.call(this,"ConvertWorker to "+o),this.destType=o}s.inherits(i,n),i.prototype.processChunk=function(o){this.push({data:s.transformTo(this.destType,o.data),meta:o.meta})},f.exports=i},{"../utils":32,"./GenericWorker":28}],25:[function(t,f,u){var n=t("./GenericWorker"),s=t("../crc32");function i(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(i,n),i.prototype.processChunk=function(o){this.streamInfo.crc32=s(o.data,this.streamInfo.crc32||0),this.push(o)},f.exports=i},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,f,u){var n=t("../utils"),s=t("./GenericWorker");function i(o){s.call(this,"DataLengthProbe for "+o),this.propName=o,this.withStreamInfo(o,0)}n.inherits(i,s),i.prototype.processChunk=function(o){if(o){var h=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=h+o.data.length}s.prototype.processChunk.call(this,o)},f.exports=i},{"../utils":32,"./GenericWorker":28}],27:[function(t,f,u){var n=t("../utils"),s=t("./GenericWorker");function i(o){s.call(this,"DataWorker");var h=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,o.then(function(m){h.dataIsReady=!0,h.data=m,h.max=m&&m.length||0,h.type=n.getTypeOf(m),h.isPaused||h._tickAndRepeat()},function(m){h.error(m)})}n.inherits(i,s),i.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},i.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},i.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},i.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var o=null,h=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":o=this.data.substring(this.index,h);break;case"uint8array":o=this.data.subarray(this.index,h);break;case"array":case"nodebuffer":o=this.data.slice(this.index,h)}return this.index=h,this.push({data:o,meta:{percent:this.max?this.index/this.max*100:0}})},f.exports=i},{"../utils":32,"./GenericWorker":28}],28:[function(t,f,u){function n(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,i){return this._listeners[s].push(i),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,i){if(this._listeners[s])for(var o=0;o<this._listeners[s].length;o++)this._listeners[s][o].call(this,i)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var i=this;return s.on("data",function(o){i.processChunk(o)}),s.on("end",function(){i.end()}),s.on("error",function(o){i.error(o)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,i){return this.extraStreamInfo[s]=i,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},f.exports=n},{}],29:[function(t,f,u){var n=t("../utils"),s=t("./ConvertWorker"),i=t("./GenericWorker"),o=t("../base64"),h=t("../support"),m=t("../external"),y=null;if(h.nodestream)try{y=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function _(g,l){return new m.Promise(function(p,d){var k=[],C=g._internalType,x=g._outputType,D=g._mimeType;g.on("data",function(L,T){k.push(L),l&&l(T)}).on("error",function(L){k=[],d(L)}).on("end",function(){try{var L=function(T,j,z){switch(T){case"blob":return n.newBlob(n.transformTo("arraybuffer",j),z);case"base64":return o.encode(j);default:return n.transformTo(T,j)}}(x,function(T,j){var z,Y=0,rt=null,E=0;for(z=0;z<j.length;z++)E+=j[z].length;switch(T){case"string":return j.join("");case"array":return Array.prototype.concat.apply([],j);case"uint8array":for(rt=new Uint8Array(E),z=0;z<j.length;z++)rt.set(j[z],Y),Y+=j[z].length;return rt;case"nodebuffer":return Buffer.concat(j);default:throw new Error("concat : unsupported type '"+T+"'")}}(C,k),D);p(L)}catch(T){d(T)}k=[]}).resume()})}function c(g,l,p){var d=l;switch(l){case"blob":case"arraybuffer":d="uint8array";break;case"base64":d="string"}try{this._internalType=d,this._outputType=l,this._mimeType=p,n.checkSupport(d),this._worker=g.pipe(new s(d)),g.lock()}catch(k){this._worker=new i("error"),this._worker.error(k)}}c.prototype={accumulate:function(g){return _(this,g)},on:function(g,l){var p=this;return g==="data"?this._worker.on(g,function(d){l.call(p,d.data,d.meta)}):this._worker.on(g,function(){n.delay(l,arguments,p)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(g){if(n.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new y(this,{objectMode:this._outputType!=="nodebuffer"},g)}},f.exports=c},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,f,u){if(u.base64=!0,u.array=!0,u.string=!0,u.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",u.nodebuffer=typeof Buffer<"u",u.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")u.blob=!1;else{var n=new ArrayBuffer(0);try{u.blob=new Blob([n],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(n),u.blob=s.getBlob("application/zip").size===0}catch{u.blob=!1}}}try{u.nodestream=!!t("readable-stream").Readable}catch{u.nodestream=!1}},{"readable-stream":16}],31:[function(t,f,u){for(var n=t("./utils"),s=t("./support"),i=t("./nodejsUtils"),o=t("./stream/GenericWorker"),h=new Array(256),m=0;m<256;m++)h[m]=252<=m?6:248<=m?5:240<=m?4:224<=m?3:192<=m?2:1;h[254]=h[254]=1;function y(){o.call(this,"utf-8 decode"),this.leftOver=null}function _(){o.call(this,"utf-8 encode")}u.utf8encode=function(c){return s.nodebuffer?i.newBufferFrom(c,"utf-8"):function(g){var l,p,d,k,C,x=g.length,D=0;for(k=0;k<x;k++)(64512&(p=g.charCodeAt(k)))==55296&&k+1<x&&(64512&(d=g.charCodeAt(k+1)))==56320&&(p=65536+(p-55296<<10)+(d-56320),k++),D+=p<128?1:p<2048?2:p<65536?3:4;for(l=s.uint8array?new Uint8Array(D):new Array(D),k=C=0;C<D;k++)(64512&(p=g.charCodeAt(k)))==55296&&k+1<x&&(64512&(d=g.charCodeAt(k+1)))==56320&&(p=65536+(p-55296<<10)+(d-56320),k++),p<128?l[C++]=p:(p<2048?l[C++]=192|p>>>6:(p<65536?l[C++]=224|p>>>12:(l[C++]=240|p>>>18,l[C++]=128|p>>>12&63),l[C++]=128|p>>>6&63),l[C++]=128|63&p);return l}(c)},u.utf8decode=function(c){return s.nodebuffer?n.transformTo("nodebuffer",c).toString("utf-8"):function(g){var l,p,d,k,C=g.length,x=new Array(2*C);for(l=p=0;l<C;)if((d=g[l++])<128)x[p++]=d;else if(4<(k=h[d]))x[p++]=65533,l+=k-1;else{for(d&=k===2?31:k===3?15:7;1<k&&l<C;)d=d<<6|63&g[l++],k--;1<k?x[p++]=65533:d<65536?x[p++]=d:(d-=65536,x[p++]=55296|d>>10&1023,x[p++]=56320|1023&d)}return x.length!==p&&(x.subarray?x=x.subarray(0,p):x.length=p),n.applyFromCharCode(x)}(c=n.transformTo(s.uint8array?"uint8array":"array",c))},n.inherits(y,o),y.prototype.processChunk=function(c){var g=n.transformTo(s.uint8array?"uint8array":"array",c.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var l=g;(g=new Uint8Array(l.length+this.leftOver.length)).set(this.leftOver,0),g.set(l,this.leftOver.length)}else g=this.leftOver.concat(g);this.leftOver=null}var p=function(k,C){var x;for((C=C||k.length)>k.length&&(C=k.length),x=C-1;0<=x&&(192&k[x])==128;)x--;return x<0||x===0?C:x+h[k[x]]>C?x:C}(g),d=g;p!==g.length&&(s.uint8array?(d=g.subarray(0,p),this.leftOver=g.subarray(p,g.length)):(d=g.slice(0,p),this.leftOver=g.slice(p,g.length))),this.push({data:u.utf8decode(d),meta:c.meta})},y.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:u.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},u.Utf8DecodeWorker=y,n.inherits(_,o),_.prototype.processChunk=function(c){this.push({data:u.utf8encode(c.data),meta:c.meta})},u.Utf8EncodeWorker=_},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,f,u){var n=t("./support"),s=t("./base64"),i=t("./nodejsUtils"),o=t("./external");function h(l){return l}function m(l,p){for(var d=0;d<l.length;++d)p[d]=255&l.charCodeAt(d);return p}t("setimmediate"),u.newBlob=function(l,p){u.checkSupport("blob");try{return new Blob([l],{type:p})}catch{try{var d=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return d.append(l),d.getBlob(p)}catch{throw new Error("Bug : can't construct the Blob.")}}};var y={stringifyByChunk:function(l,p,d){var k=[],C=0,x=l.length;if(x<=d)return String.fromCharCode.apply(null,l);for(;C<x;)p==="array"||p==="nodebuffer"?k.push(String.fromCharCode.apply(null,l.slice(C,Math.min(C+d,x)))):k.push(String.fromCharCode.apply(null,l.subarray(C,Math.min(C+d,x)))),C+=d;return k.join("")},stringifyByChar:function(l){for(var p="",d=0;d<l.length;d++)p+=String.fromCharCode(l[d]);return p},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&String.fromCharCode.apply(null,i.allocBuffer(1)).length===1}catch{return!1}}()}};function _(l){var p=65536,d=u.getTypeOf(l),k=!0;if(d==="uint8array"?k=y.applyCanBeUsed.uint8array:d==="nodebuffer"&&(k=y.applyCanBeUsed.nodebuffer),k)for(;1<p;)try{return y.stringifyByChunk(l,d,p)}catch{p=Math.floor(p/2)}return y.stringifyByChar(l)}function c(l,p){for(var d=0;d<l.length;d++)p[d]=l[d];return p}u.applyFromCharCode=_;var g={};g.string={string:h,array:function(l){return m(l,new Array(l.length))},arraybuffer:function(l){return g.string.uint8array(l).buffer},uint8array:function(l){return m(l,new Uint8Array(l.length))},nodebuffer:function(l){return m(l,i.allocBuffer(l.length))}},g.array={string:_,array:h,arraybuffer:function(l){return new Uint8Array(l).buffer},uint8array:function(l){return new Uint8Array(l)},nodebuffer:function(l){return i.newBufferFrom(l)}},g.arraybuffer={string:function(l){return _(new Uint8Array(l))},array:function(l){return c(new Uint8Array(l),new Array(l.byteLength))},arraybuffer:h,uint8array:function(l){return new Uint8Array(l)},nodebuffer:function(l){return i.newBufferFrom(new Uint8Array(l))}},g.uint8array={string:_,array:function(l){return c(l,new Array(l.length))},arraybuffer:function(l){return l.buffer},uint8array:h,nodebuffer:function(l){return i.newBufferFrom(l)}},g.nodebuffer={string:_,array:function(l){return c(l,new Array(l.length))},arraybuffer:function(l){return g.nodebuffer.uint8array(l).buffer},uint8array:function(l){return c(l,new Uint8Array(l.length))},nodebuffer:h},u.transformTo=function(l,p){if(p=p||"",!l)return p;u.checkSupport(l);var d=u.getTypeOf(p);return g[d][l](p)},u.resolve=function(l){for(var p=l.split("/"),d=[],k=0;k<p.length;k++){var C=p[k];C==="."||C===""&&k!==0&&k!==p.length-1||(C===".."?d.pop():d.push(C))}return d.join("/")},u.getTypeOf=function(l){return typeof l=="string"?"string":Object.prototype.toString.call(l)==="[object Array]"?"array":n.nodebuffer&&i.isBuffer(l)?"nodebuffer":n.uint8array&&l instanceof Uint8Array?"uint8array":n.arraybuffer&&l instanceof ArrayBuffer?"arraybuffer":void 0},u.checkSupport=function(l){if(!n[l.toLowerCase()])throw new Error(l+" is not supported by this platform")},u.MAX_VALUE_16BITS=65535,u.MAX_VALUE_32BITS=-1,u.pretty=function(l){var p,d,k="";for(d=0;d<(l||"").length;d++)k+="\\x"+((p=l.charCodeAt(d))<16?"0":"")+p.toString(16).toUpperCase();return k},u.delay=function(l,p,d){setImmediate(function(){l.apply(d||null,p||[])})},u.inherits=function(l,p){function d(){}d.prototype=p.prototype,l.prototype=new d},u.extend=function(){var l,p,d={};for(l=0;l<arguments.length;l++)for(p in arguments[l])Object.prototype.hasOwnProperty.call(arguments[l],p)&&d[p]===void 0&&(d[p]=arguments[l][p]);return d},u.prepareContent=function(l,p,d,k,C){return o.Promise.resolve(p).then(function(x){return n.blob&&(x instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(x))!==-1)&&typeof FileReader<"u"?new o.Promise(function(D,L){var T=new FileReader;T.onload=function(j){D(j.target.result)},T.onerror=function(j){L(j.target.error)},T.readAsArrayBuffer(x)}):x}).then(function(x){var D=u.getTypeOf(x);return D?(D==="arraybuffer"?x=u.transformTo("uint8array",x):D==="string"&&(C?x=s.decode(x):d&&k!==!0&&(x=function(L){return m(L,n.uint8array?new Uint8Array(L.length):new Array(L.length))}(x))),x):o.Promise.reject(new Error("Can't read the data of '"+l+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,f,u){var n=t("./reader/readerFor"),s=t("./utils"),i=t("./signature"),o=t("./zipEntry"),h=t("./support");function m(y){this.files=[],this.loadOptions=y}m.prototype={checkSignature:function(y){if(!this.reader.readAndCheckSignature(y)){this.reader.index-=4;var _=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(_)+", expected "+s.pretty(y)+")")}},isSignature:function(y,_){var c=this.reader.index;this.reader.setIndex(y);var g=this.reader.readString(4)===_;return this.reader.setIndex(c),g},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var y=this.reader.readData(this.zipCommentLength),_=h.uint8array?"uint8array":"array",c=s.transformTo(_,y);this.zipComment=this.loadOptions.decodeFileName(c)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var y,_,c,g=this.zip64EndOfCentralSize-44;0<g;)y=this.reader.readInt(2),_=this.reader.readInt(4),c=this.reader.readData(_),this.zip64ExtensibleData[y]={id:y,length:_,value:c}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var y,_;for(y=0;y<this.files.length;y++)_=this.files[y],this.reader.setIndex(_.localHeaderOffset),this.checkSignature(i.LOCAL_FILE_HEADER),_.readLocalPart(this.reader),_.handleUTF8(),_.processAttributes()},readCentralDir:function(){var y;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(i.CENTRAL_FILE_HEADER);)(y=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(y);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var y=this.reader.lastIndexOfSignature(i.CENTRAL_DIRECTORY_END);if(y<0)throw this.isSignature(0,i.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(y);var _=y;if(this.checkSignature(i.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(y=this.reader.lastIndexOfSignature(i.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(y),this.checkSignature(i.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,i.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(i.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(i.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var c=this.centralDirOffset+this.centralDirSize;this.zip64&&(c+=20,c+=12+this.zip64EndOfCentralSize);var g=_-c;if(0<g)this.isSignature(_,i.CENTRAL_FILE_HEADER)||(this.reader.zero=g);else if(g<0)throw new Error("Corrupted zip: missing "+Math.abs(g)+" bytes.")},prepareReader:function(y){this.reader=n(y)},load:function(y){this.prepareReader(y),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},f.exports=m},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,f,u){var n=t("./reader/readerFor"),s=t("./utils"),i=t("./compressedObject"),o=t("./crc32"),h=t("./utf8"),m=t("./compressions"),y=t("./support");function _(c,g){this.options=c,this.loadOptions=g}_.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(c){var g,l;if(c.skip(22),this.fileNameLength=c.readInt(2),l=c.readInt(2),this.fileName=c.readData(this.fileNameLength),c.skip(l),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((g=function(p){for(var d in m)if(Object.prototype.hasOwnProperty.call(m,d)&&m[d].magic===p)return m[d];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new i(this.compressedSize,this.uncompressedSize,this.crc32,g,c.readData(this.compressedSize))},readCentralPart:function(c){this.versionMadeBy=c.readInt(2),c.skip(2),this.bitFlag=c.readInt(2),this.compressionMethod=c.readString(2),this.date=c.readDate(),this.crc32=c.readInt(4),this.compressedSize=c.readInt(4),this.uncompressedSize=c.readInt(4);var g=c.readInt(2);if(this.extraFieldsLength=c.readInt(2),this.fileCommentLength=c.readInt(2),this.diskNumberStart=c.readInt(2),this.internalFileAttributes=c.readInt(2),this.externalFileAttributes=c.readInt(4),this.localHeaderOffset=c.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");c.skip(g),this.readExtraFields(c),this.parseZIP64ExtraField(c),this.fileComment=c.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var c=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),c==0&&(this.dosPermissions=63&this.externalFileAttributes),c==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var c=n(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=c.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=c.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=c.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=c.readInt(4))}},readExtraFields:function(c){var g,l,p,d=c.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});c.index+4<d;)g=c.readInt(2),l=c.readInt(2),p=c.readData(l),this.extraFields[g]={id:g,length:l,value:p};c.setIndex(d)},handleUTF8:function(){var c=y.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=h.utf8decode(this.fileName),this.fileCommentStr=h.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var l=s.transformTo(c,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(l)}var p=this.findExtraFieldUnicodeComment();if(p!==null)this.fileCommentStr=p;else{var d=s.transformTo(c,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(d)}}},findExtraFieldUnicodePath:function(){var c=this.extraFields[28789];if(c){var g=n(c.value);return g.readInt(1)!==1||o(this.fileName)!==g.readInt(4)?null:h.utf8decode(g.readData(c.length-5))}return null},findExtraFieldUnicodeComment:function(){var c=this.extraFields[25461];if(c){var g=n(c.value);return g.readInt(1)!==1||o(this.fileComment)!==g.readInt(4)?null:h.utf8decode(g.readData(c.length-5))}return null}},f.exports=_},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,f,u){function n(g,l,p){this.name=g,this.dir=p.dir,this.date=p.date,this.comment=p.comment,this.unixPermissions=p.unixPermissions,this.dosPermissions=p.dosPermissions,this._data=l,this._dataBinary=p.binary,this.options={compression:p.compression,compressionOptions:p.compressionOptions}}var s=t("./stream/StreamHelper"),i=t("./stream/DataWorker"),o=t("./utf8"),h=t("./compressedObject"),m=t("./stream/GenericWorker");n.prototype={internalStream:function(g){var l=null,p="string";try{if(!g)throw new Error("No output type specified.");var d=(p=g.toLowerCase())==="string"||p==="text";p!=="binarystring"&&p!=="text"||(p="string"),l=this._decompressWorker();var k=!this._dataBinary;k&&!d&&(l=l.pipe(new o.Utf8EncodeWorker)),!k&&d&&(l=l.pipe(new o.Utf8DecodeWorker))}catch(C){(l=new m("error")).error(C)}return new s(l,p,"")},async:function(g,l){return this.internalStream(g).accumulate(l)},nodeStream:function(g,l){return this.internalStream(g||"nodebuffer").toNodejsStream(l)},_compressWorker:function(g,l){if(this._data instanceof h&&this._data.compression.magic===g.magic)return this._data.getCompressedWorker();var p=this._decompressWorker();return this._dataBinary||(p=p.pipe(new o.Utf8EncodeWorker)),h.createWorkerFrom(p,g,l)},_decompressWorker:function(){return this._data instanceof h?this._data.getContentWorker():this._data instanceof m?this._data:new i(this._data)}};for(var y=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],_=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},c=0;c<y.length;c++)n.prototype[y[c]]=_;f.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,f,u){(function(n){var s,i,o=n.MutationObserver||n.WebKitMutationObserver;if(o){var h=0,m=new o(g),y=n.document.createTextNode("");m.observe(y,{characterData:!0}),s=function(){y.data=h=++h%2}}else if(n.setImmediate||n.MessageChannel===void 0)s="document"in n&&"onreadystatechange"in n.document.createElement("script")?function(){var l=n.document.createElement("script");l.onreadystatechange=function(){g(),l.onreadystatechange=null,l.parentNode.removeChild(l),l=null},n.document.documentElement.appendChild(l)}:function(){setTimeout(g,0)};else{var _=new n.MessageChannel;_.port1.onmessage=g,s=function(){_.port2.postMessage(0)}}var c=[];function g(){var l,p;i=!0;for(var d=c.length;d;){for(p=c,c=[],l=-1;++l<d;)p[l]();d=c.length}i=!1}f.exports=function(l){c.push(l)!==1||i||s()}}).call(this,typeof Pt<"u"?Pt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,f,u){var n=t("immediate");function s(){}var i={},o=["REJECTED"],h=["FULFILLED"],m=["PENDING"];function y(d){if(typeof d!="function")throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,d!==s&&l(this,d)}function _(d,k,C){this.promise=d,typeof k=="function"&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),typeof C=="function"&&(this.onRejected=C,this.callRejected=this.otherCallRejected)}function c(d,k,C){n(function(){var x;try{x=k(C)}catch(D){return i.reject(d,D)}x===d?i.reject(d,new TypeError("Cannot resolve promise with itself")):i.resolve(d,x)})}function g(d){var k=d&&d.then;if(d&&(typeof d=="object"||typeof d=="function")&&typeof k=="function")return function(){k.apply(d,arguments)}}function l(d,k){var C=!1;function x(T){C||(C=!0,i.reject(d,T))}function D(T){C||(C=!0,i.resolve(d,T))}var L=p(function(){k(D,x)});L.status==="error"&&x(L.value)}function p(d,k){var C={};try{C.value=d(k),C.status="success"}catch(x){C.status="error",C.value=x}return C}(f.exports=y).prototype.finally=function(d){if(typeof d!="function")return this;var k=this.constructor;return this.then(function(C){return k.resolve(d()).then(function(){return C})},function(C){return k.resolve(d()).then(function(){throw C})})},y.prototype.catch=function(d){return this.then(null,d)},y.prototype.then=function(d,k){if(typeof d!="function"&&this.state===h||typeof k!="function"&&this.state===o)return this;var C=new this.constructor(s);return this.state!==m?c(C,this.state===h?d:k,this.outcome):this.queue.push(new _(C,d,k)),C},_.prototype.callFulfilled=function(d){i.resolve(this.promise,d)},_.prototype.otherCallFulfilled=function(d){c(this.promise,this.onFulfilled,d)},_.prototype.callRejected=function(d){i.reject(this.promise,d)},_.prototype.otherCallRejected=function(d){c(this.promise,this.onRejected,d)},i.resolve=function(d,k){var C=p(g,k);if(C.status==="error")return i.reject(d,C.value);var x=C.value;if(x)l(d,x);else{d.state=h,d.outcome=k;for(var D=-1,L=d.queue.length;++D<L;)d.queue[D].callFulfilled(k)}return d},i.reject=function(d,k){d.state=o,d.outcome=k;for(var C=-1,x=d.queue.length;++C<x;)d.queue[C].callRejected(k);return d},y.resolve=function(d){return d instanceof this?d:i.resolve(new this(s),d)},y.reject=function(d){var k=new this(s);return i.reject(k,d)},y.all=function(d){var k=this;if(Object.prototype.toString.call(d)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=d.length,x=!1;if(!C)return this.resolve([]);for(var D=new Array(C),L=0,T=-1,j=new this(s);++T<C;)z(d[T],T);return j;function z(Y,rt){k.resolve(Y).then(function(E){D[rt]=E,++L!==C||x||(x=!0,i.resolve(j,D))},function(E){x||(x=!0,i.reject(j,E))})}},y.race=function(d){var k=this;if(Object.prototype.toString.call(d)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=d.length,x=!1;if(!C)return this.resolve([]);for(var D=-1,L=new this(s);++D<C;)T=d[D],k.resolve(T).then(function(j){x||(x=!0,i.resolve(L,j))},function(j){x||(x=!0,i.reject(L,j))});var T;return L}},{immediate:36}],38:[function(t,f,u){var n={};(0,t("./lib/utils/common").assign)(n,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),f.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,f,u){var n=t("./zlib/deflate"),s=t("./utils/common"),i=t("./utils/strings"),o=t("./zlib/messages"),h=t("./zlib/zstream"),m=Object.prototype.toString,y=0,_=-1,c=0,g=8;function l(d){if(!(this instanceof l))return new l(d);this.options=s.assign({level:_,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:c,to:""},d||{});var k=this.options;k.raw&&0<k.windowBits?k.windowBits=-k.windowBits:k.gzip&&0<k.windowBits&&k.windowBits<16&&(k.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var C=n.deflateInit2(this.strm,k.level,k.method,k.windowBits,k.memLevel,k.strategy);if(C!==y)throw new Error(o[C]);if(k.header&&n.deflateSetHeader(this.strm,k.header),k.dictionary){var x;if(x=typeof k.dictionary=="string"?i.string2buf(k.dictionary):m.call(k.dictionary)==="[object ArrayBuffer]"?new Uint8Array(k.dictionary):k.dictionary,(C=n.deflateSetDictionary(this.strm,x))!==y)throw new Error(o[C]);this._dict_set=!0}}function p(d,k){var C=new l(k);if(C.push(d,!0),C.err)throw C.msg||o[C.err];return C.result}l.prototype.push=function(d,k){var C,x,D=this.strm,L=this.options.chunkSize;if(this.ended)return!1;x=k===~~k?k:k===!0?4:0,typeof d=="string"?D.input=i.string2buf(d):m.call(d)==="[object ArrayBuffer]"?D.input=new Uint8Array(d):D.input=d,D.next_in=0,D.avail_in=D.input.length;do{if(D.avail_out===0&&(D.output=new s.Buf8(L),D.next_out=0,D.avail_out=L),(C=n.deflate(D,x))!==1&&C!==y)return this.onEnd(C),!(this.ended=!0);D.avail_out!==0&&(D.avail_in!==0||x!==4&&x!==2)||(this.options.to==="string"?this.onData(i.buf2binstring(s.shrinkBuf(D.output,D.next_out))):this.onData(s.shrinkBuf(D.output,D.next_out)))}while((0<D.avail_in||D.avail_out===0)&&C!==1);return x===4?(C=n.deflateEnd(this.strm),this.onEnd(C),this.ended=!0,C===y):x!==2||(this.onEnd(y),!(D.avail_out=0))},l.prototype.onData=function(d){this.chunks.push(d)},l.prototype.onEnd=function(d){d===y&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg},u.Deflate=l,u.deflate=p,u.deflateRaw=function(d,k){return(k=k||{}).raw=!0,p(d,k)},u.gzip=function(d,k){return(k=k||{}).gzip=!0,p(d,k)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,f,u){var n=t("./zlib/inflate"),s=t("./utils/common"),i=t("./utils/strings"),o=t("./zlib/constants"),h=t("./zlib/messages"),m=t("./zlib/zstream"),y=t("./zlib/gzheader"),_=Object.prototype.toString;function c(l){if(!(this instanceof c))return new c(l);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},l||{});var p=this.options;p.raw&&0<=p.windowBits&&p.windowBits<16&&(p.windowBits=-p.windowBits,p.windowBits===0&&(p.windowBits=-15)),!(0<=p.windowBits&&p.windowBits<16)||l&&l.windowBits||(p.windowBits+=32),15<p.windowBits&&p.windowBits<48&&!(15&p.windowBits)&&(p.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var d=n.inflateInit2(this.strm,p.windowBits);if(d!==o.Z_OK)throw new Error(h[d]);this.header=new y,n.inflateGetHeader(this.strm,this.header)}function g(l,p){var d=new c(p);if(d.push(l,!0),d.err)throw d.msg||h[d.err];return d.result}c.prototype.push=function(l,p){var d,k,C,x,D,L,T=this.strm,j=this.options.chunkSize,z=this.options.dictionary,Y=!1;if(this.ended)return!1;k=p===~~p?p:p===!0?o.Z_FINISH:o.Z_NO_FLUSH,typeof l=="string"?T.input=i.binstring2buf(l):_.call(l)==="[object ArrayBuffer]"?T.input=new Uint8Array(l):T.input=l,T.next_in=0,T.avail_in=T.input.length;do{if(T.avail_out===0&&(T.output=new s.Buf8(j),T.next_out=0,T.avail_out=j),(d=n.inflate(T,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&z&&(L=typeof z=="string"?i.string2buf(z):_.call(z)==="[object ArrayBuffer]"?new Uint8Array(z):z,d=n.inflateSetDictionary(this.strm,L)),d===o.Z_BUF_ERROR&&Y===!0&&(d=o.Z_OK,Y=!1),d!==o.Z_STREAM_END&&d!==o.Z_OK)return this.onEnd(d),!(this.ended=!0);T.next_out&&(T.avail_out!==0&&d!==o.Z_STREAM_END&&(T.avail_in!==0||k!==o.Z_FINISH&&k!==o.Z_SYNC_FLUSH)||(this.options.to==="string"?(C=i.utf8border(T.output,T.next_out),x=T.next_out-C,D=i.buf2string(T.output,C),T.next_out=x,T.avail_out=j-x,x&&s.arraySet(T.output,T.output,C,x,0),this.onData(D)):this.onData(s.shrinkBuf(T.output,T.next_out)))),T.avail_in===0&&T.avail_out===0&&(Y=!0)}while((0<T.avail_in||T.avail_out===0)&&d!==o.Z_STREAM_END);return d===o.Z_STREAM_END&&(k=o.Z_FINISH),k===o.Z_FINISH?(d=n.inflateEnd(this.strm),this.onEnd(d),this.ended=!0,d===o.Z_OK):k!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(T.avail_out=0))},c.prototype.onData=function(l){this.chunks.push(l)},c.prototype.onEnd=function(l){l===o.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=l,this.msg=this.strm.msg},u.Inflate=c,u.inflate=g,u.inflateRaw=function(l,p){return(p=p||{}).raw=!0,g(l,p)},u.ungzip=g},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,f,u){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";u.assign=function(o){for(var h=Array.prototype.slice.call(arguments,1);h.length;){var m=h.shift();if(m){if(typeof m!="object")throw new TypeError(m+"must be non-object");for(var y in m)m.hasOwnProperty(y)&&(o[y]=m[y])}}return o},u.shrinkBuf=function(o,h){return o.length===h?o:o.subarray?o.subarray(0,h):(o.length=h,o)};var s={arraySet:function(o,h,m,y,_){if(h.subarray&&o.subarray)o.set(h.subarray(m,m+y),_);else for(var c=0;c<y;c++)o[_+c]=h[m+c]},flattenChunks:function(o){var h,m,y,_,c,g;for(h=y=0,m=o.length;h<m;h++)y+=o[h].length;for(g=new Uint8Array(y),h=_=0,m=o.length;h<m;h++)c=o[h],g.set(c,_),_+=c.length;return g}},i={arraySet:function(o,h,m,y,_){for(var c=0;c<y;c++)o[_+c]=h[m+c]},flattenChunks:function(o){return[].concat.apply([],o)}};u.setTyped=function(o){o?(u.Buf8=Uint8Array,u.Buf16=Uint16Array,u.Buf32=Int32Array,u.assign(u,s)):(u.Buf8=Array,u.Buf16=Array,u.Buf32=Array,u.assign(u,i))},u.setTyped(n)},{}],42:[function(t,f,u){var n=t("./common"),s=!0,i=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{i=!1}for(var o=new n.Buf8(256),h=0;h<256;h++)o[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;function m(y,_){if(_<65537&&(y.subarray&&i||!y.subarray&&s))return String.fromCharCode.apply(null,n.shrinkBuf(y,_));for(var c="",g=0;g<_;g++)c+=String.fromCharCode(y[g]);return c}o[254]=o[254]=1,u.string2buf=function(y){var _,c,g,l,p,d=y.length,k=0;for(l=0;l<d;l++)(64512&(c=y.charCodeAt(l)))==55296&&l+1<d&&(64512&(g=y.charCodeAt(l+1)))==56320&&(c=65536+(c-55296<<10)+(g-56320),l++),k+=c<128?1:c<2048?2:c<65536?3:4;for(_=new n.Buf8(k),l=p=0;p<k;l++)(64512&(c=y.charCodeAt(l)))==55296&&l+1<d&&(64512&(g=y.charCodeAt(l+1)))==56320&&(c=65536+(c-55296<<10)+(g-56320),l++),c<128?_[p++]=c:(c<2048?_[p++]=192|c>>>6:(c<65536?_[p++]=224|c>>>12:(_[p++]=240|c>>>18,_[p++]=128|c>>>12&63),_[p++]=128|c>>>6&63),_[p++]=128|63&c);return _},u.buf2binstring=function(y){return m(y,y.length)},u.binstring2buf=function(y){for(var _=new n.Buf8(y.length),c=0,g=_.length;c<g;c++)_[c]=y.charCodeAt(c);return _},u.buf2string=function(y,_){var c,g,l,p,d=_||y.length,k=new Array(2*d);for(c=g=0;c<d;)if((l=y[c++])<128)k[g++]=l;else if(4<(p=o[l]))k[g++]=65533,c+=p-1;else{for(l&=p===2?31:p===3?15:7;1<p&&c<d;)l=l<<6|63&y[c++],p--;1<p?k[g++]=65533:l<65536?k[g++]=l:(l-=65536,k[g++]=55296|l>>10&1023,k[g++]=56320|1023&l)}return m(k,g)},u.utf8border=function(y,_){var c;for((_=_||y.length)>y.length&&(_=y.length),c=_-1;0<=c&&(192&y[c])==128;)c--;return c<0||c===0?_:c+o[y[c]]>_?c:_}},{"./common":41}],43:[function(t,f,u){f.exports=function(n,s,i,o){for(var h=65535&n|0,m=n>>>16&65535|0,y=0;i!==0;){for(i-=y=2e3<i?2e3:i;m=m+(h=h+s[o++]|0)|0,--y;);h%=65521,m%=65521}return h|m<<16|0}},{}],44:[function(t,f,u){f.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,f,u){var n=function(){for(var s,i=[],o=0;o<256;o++){s=o;for(var h=0;h<8;h++)s=1&s?3988292384^s>>>1:s>>>1;i[o]=s}return i}();f.exports=function(s,i,o,h){var m=n,y=h+o;s^=-1;for(var _=h;_<y;_++)s=s>>>8^m[255&(s^i[_])];return-1^s}},{}],46:[function(t,f,u){var n,s=t("../utils/common"),i=t("./trees"),o=t("./adler32"),h=t("./crc32"),m=t("./messages"),y=0,_=4,c=0,g=-2,l=-1,p=4,d=2,k=8,C=9,x=286,D=30,L=19,T=2*x+1,j=15,z=3,Y=258,rt=Y+z+1,E=42,B=113,a=1,N=2,nt=3,Z=4;function st(e,F){return e.msg=m[F],F}function U(e){return(e<<1)-(4<e?9:0)}function it(e){for(var F=e.length;0<=--F;)e[F]=0}function O(e){var F=e.state,M=F.pending;M>e.avail_out&&(M=e.avail_out),M!==0&&(s.arraySet(e.output,F.pending_buf,F.pending_out,M,e.next_out),e.next_out+=M,F.pending_out+=M,e.total_out+=M,e.avail_out-=M,F.pending-=M,F.pending===0&&(F.pending_out=0))}function R(e,F){i._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,F),e.block_start=e.strstart,O(e.strm)}function et(e,F){e.pending_buf[e.pending++]=F}function Q(e,F){e.pending_buf[e.pending++]=F>>>8&255,e.pending_buf[e.pending++]=255&F}function X(e,F){var M,v,w=e.max_chain_length,A=e.strstart,P=e.prev_length,W=e.nice_match,I=e.strstart>e.w_size-rt?e.strstart-(e.w_size-rt):0,V=e.window,J=e.w_mask,G=e.prev,tt=e.strstart+Y,pt=V[A+P-1],ct=V[A+P];e.prev_length>=e.good_match&&(w>>=2),W>e.lookahead&&(W=e.lookahead);do if(V[(M=F)+P]===ct&&V[M+P-1]===pt&&V[M]===V[A]&&V[++M]===V[A+1]){A+=2,M++;do;while(V[++A]===V[++M]&&V[++A]===V[++M]&&V[++A]===V[++M]&&V[++A]===V[++M]&&V[++A]===V[++M]&&V[++A]===V[++M]&&V[++A]===V[++M]&&V[++A]===V[++M]&&A<tt);if(v=Y-(tt-A),A=tt-Y,P<v){if(e.match_start=F,W<=(P=v))break;pt=V[A+P-1],ct=V[A+P]}}while((F=G[F&J])>I&&--w!=0);return P<=e.lookahead?P:e.lookahead}function gt(e){var F,M,v,w,A,P,W,I,V,J,G=e.w_size;do{if(w=e.window_size-e.lookahead-e.strstart,e.strstart>=G+(G-rt)){for(s.arraySet(e.window,e.window,G,G,0),e.match_start-=G,e.strstart-=G,e.block_start-=G,F=M=e.hash_size;v=e.head[--F],e.head[F]=G<=v?v-G:0,--M;);for(F=M=G;v=e.prev[--F],e.prev[F]=G<=v?v-G:0,--M;);w+=G}if(e.strm.avail_in===0)break;if(P=e.strm,W=e.window,I=e.strstart+e.lookahead,V=w,J=void 0,J=P.avail_in,V<J&&(J=V),M=J===0?0:(P.avail_in-=J,s.arraySet(W,P.input,P.next_in,J,I),P.state.wrap===1?P.adler=o(P.adler,W,J,I):P.state.wrap===2&&(P.adler=h(P.adler,W,J,I)),P.next_in+=J,P.total_in+=J,J),e.lookahead+=M,e.lookahead+e.insert>=z)for(A=e.strstart-e.insert,e.ins_h=e.window[A],e.ins_h=(e.ins_h<<e.hash_shift^e.window[A+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[A+z-1])&e.hash_mask,e.prev[A&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=A,A++,e.insert--,!(e.lookahead+e.insert<z)););}while(e.lookahead<rt&&e.strm.avail_in!==0)}function vt(e,F){for(var M,v;;){if(e.lookahead<rt){if(gt(e),e.lookahead<rt&&F===y)return a;if(e.lookahead===0)break}if(M=0,e.lookahead>=z&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+z-1])&e.hash_mask,M=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),M!==0&&e.strstart-M<=e.w_size-rt&&(e.match_length=X(e,M)),e.match_length>=z)if(v=i._tr_tally(e,e.strstart-e.match_start,e.match_length-z),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=z){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+z-1])&e.hash_mask,M=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,--e.match_length!=0;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else v=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(v&&(R(e,!1),e.strm.avail_out===0))return a}return e.insert=e.strstart<z-1?e.strstart:z-1,F===_?(R(e,!0),e.strm.avail_out===0?nt:Z):e.last_lit&&(R(e,!1),e.strm.avail_out===0)?a:N}function lt(e,F){for(var M,v,w;;){if(e.lookahead<rt){if(gt(e),e.lookahead<rt&&F===y)return a;if(e.lookahead===0)break}if(M=0,e.lookahead>=z&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+z-1])&e.hash_mask,M=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=z-1,M!==0&&e.prev_length<e.max_lazy_match&&e.strstart-M<=e.w_size-rt&&(e.match_length=X(e,M),e.match_length<=5&&(e.strategy===1||e.match_length===z&&4096<e.strstart-e.match_start)&&(e.match_length=z-1)),e.prev_length>=z&&e.match_length<=e.prev_length){for(w=e.strstart+e.lookahead-z,v=i._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-z),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=w&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+z-1])&e.hash_mask,M=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),--e.prev_length!=0;);if(e.match_available=0,e.match_length=z-1,e.strstart++,v&&(R(e,!1),e.strm.avail_out===0))return a}else if(e.match_available){if((v=i._tr_tally(e,0,e.window[e.strstart-1]))&&R(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return a}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(v=i._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<z-1?e.strstart:z-1,F===_?(R(e,!0),e.strm.avail_out===0?nt:Z):e.last_lit&&(R(e,!1),e.strm.avail_out===0)?a:N}function dt(e,F,M,v,w){this.good_length=e,this.max_lazy=F,this.nice_length=M,this.max_chain=v,this.func=w}function wt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=k,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*T),this.dyn_dtree=new s.Buf16(2*(2*D+1)),this.bl_tree=new s.Buf16(2*(2*L+1)),it(this.dyn_ltree),it(this.dyn_dtree),it(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(j+1),this.heap=new s.Buf16(2*x+1),it(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*x+1),it(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function _t(e){var F;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=d,(F=e.state).pending=0,F.pending_out=0,F.wrap<0&&(F.wrap=-F.wrap),F.status=F.wrap?E:B,e.adler=F.wrap===2?0:1,F.last_flush=y,i._tr_init(F),c):st(e,g)}function At(e){var F=_t(e);return F===c&&function(M){M.window_size=2*M.w_size,it(M.head),M.max_lazy_match=n[M.level].max_lazy,M.good_match=n[M.level].good_length,M.nice_match=n[M.level].nice_length,M.max_chain_length=n[M.level].max_chain,M.strstart=0,M.block_start=0,M.lookahead=0,M.insert=0,M.match_length=M.prev_length=z-1,M.match_available=0,M.ins_h=0}(e.state),F}function Et(e,F,M,v,w,A){if(!e)return g;var P=1;if(F===l&&(F=6),v<0?(P=0,v=-v):15<v&&(P=2,v-=16),w<1||C<w||M!==k||v<8||15<v||F<0||9<F||A<0||p<A)return st(e,g);v===8&&(v=9);var W=new wt;return(e.state=W).strm=e,W.wrap=P,W.gzhead=null,W.w_bits=v,W.w_size=1<<W.w_bits,W.w_mask=W.w_size-1,W.hash_bits=w+7,W.hash_size=1<<W.hash_bits,W.hash_mask=W.hash_size-1,W.hash_shift=~~((W.hash_bits+z-1)/z),W.window=new s.Buf8(2*W.w_size),W.head=new s.Buf16(W.hash_size),W.prev=new s.Buf16(W.w_size),W.lit_bufsize=1<<w+6,W.pending_buf_size=4*W.lit_bufsize,W.pending_buf=new s.Buf8(W.pending_buf_size),W.d_buf=1*W.lit_bufsize,W.l_buf=3*W.lit_bufsize,W.level=F,W.strategy=A,W.method=M,At(e)}n=[new dt(0,0,0,0,function(e,F){var M=65535;for(M>e.pending_buf_size-5&&(M=e.pending_buf_size-5);;){if(e.lookahead<=1){if(gt(e),e.lookahead===0&&F===y)return a;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var v=e.block_start+M;if((e.strstart===0||e.strstart>=v)&&(e.lookahead=e.strstart-v,e.strstart=v,R(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-rt&&(R(e,!1),e.strm.avail_out===0))return a}return e.insert=0,F===_?(R(e,!0),e.strm.avail_out===0?nt:Z):(e.strstart>e.block_start&&(R(e,!1),e.strm.avail_out),a)}),new dt(4,4,8,4,vt),new dt(4,5,16,8,vt),new dt(4,6,32,32,vt),new dt(4,4,16,16,lt),new dt(8,16,32,32,lt),new dt(8,16,128,128,lt),new dt(8,32,128,256,lt),new dt(32,128,258,1024,lt),new dt(32,258,258,4096,lt)],u.deflateInit=function(e,F){return Et(e,F,k,15,8,0)},u.deflateInit2=Et,u.deflateReset=At,u.deflateResetKeep=_t,u.deflateSetHeader=function(e,F){return e&&e.state?e.state.wrap!==2?g:(e.state.gzhead=F,c):g},u.deflate=function(e,F){var M,v,w,A;if(!e||!e.state||5<F||F<0)return e?st(e,g):g;if(v=e.state,!e.output||!e.input&&e.avail_in!==0||v.status===666&&F!==_)return st(e,e.avail_out===0?-5:g);if(v.strm=e,M=v.last_flush,v.last_flush=F,v.status===E)if(v.wrap===2)e.adler=0,et(v,31),et(v,139),et(v,8),v.gzhead?(et(v,(v.gzhead.text?1:0)+(v.gzhead.hcrc?2:0)+(v.gzhead.extra?4:0)+(v.gzhead.name?8:0)+(v.gzhead.comment?16:0)),et(v,255&v.gzhead.time),et(v,v.gzhead.time>>8&255),et(v,v.gzhead.time>>16&255),et(v,v.gzhead.time>>24&255),et(v,v.level===9?2:2<=v.strategy||v.level<2?4:0),et(v,255&v.gzhead.os),v.gzhead.extra&&v.gzhead.extra.length&&(et(v,255&v.gzhead.extra.length),et(v,v.gzhead.extra.length>>8&255)),v.gzhead.hcrc&&(e.adler=h(e.adler,v.pending_buf,v.pending,0)),v.gzindex=0,v.status=69):(et(v,0),et(v,0),et(v,0),et(v,0),et(v,0),et(v,v.level===9?2:2<=v.strategy||v.level<2?4:0),et(v,3),v.status=B);else{var P=k+(v.w_bits-8<<4)<<8;P|=(2<=v.strategy||v.level<2?0:v.level<6?1:v.level===6?2:3)<<6,v.strstart!==0&&(P|=32),P+=31-P%31,v.status=B,Q(v,P),v.strstart!==0&&(Q(v,e.adler>>>16),Q(v,65535&e.adler)),e.adler=1}if(v.status===69)if(v.gzhead.extra){for(w=v.pending;v.gzindex<(65535&v.gzhead.extra.length)&&(v.pending!==v.pending_buf_size||(v.gzhead.hcrc&&v.pending>w&&(e.adler=h(e.adler,v.pending_buf,v.pending-w,w)),O(e),w=v.pending,v.pending!==v.pending_buf_size));)et(v,255&v.gzhead.extra[v.gzindex]),v.gzindex++;v.gzhead.hcrc&&v.pending>w&&(e.adler=h(e.adler,v.pending_buf,v.pending-w,w)),v.gzindex===v.gzhead.extra.length&&(v.gzindex=0,v.status=73)}else v.status=73;if(v.status===73)if(v.gzhead.name){w=v.pending;do{if(v.pending===v.pending_buf_size&&(v.gzhead.hcrc&&v.pending>w&&(e.adler=h(e.adler,v.pending_buf,v.pending-w,w)),O(e),w=v.pending,v.pending===v.pending_buf_size)){A=1;break}A=v.gzindex<v.gzhead.name.length?255&v.gzhead.name.charCodeAt(v.gzindex++):0,et(v,A)}while(A!==0);v.gzhead.hcrc&&v.pending>w&&(e.adler=h(e.adler,v.pending_buf,v.pending-w,w)),A===0&&(v.gzindex=0,v.status=91)}else v.status=91;if(v.status===91)if(v.gzhead.comment){w=v.pending;do{if(v.pending===v.pending_buf_size&&(v.gzhead.hcrc&&v.pending>w&&(e.adler=h(e.adler,v.pending_buf,v.pending-w,w)),O(e),w=v.pending,v.pending===v.pending_buf_size)){A=1;break}A=v.gzindex<v.gzhead.comment.length?255&v.gzhead.comment.charCodeAt(v.gzindex++):0,et(v,A)}while(A!==0);v.gzhead.hcrc&&v.pending>w&&(e.adler=h(e.adler,v.pending_buf,v.pending-w,w)),A===0&&(v.status=103)}else v.status=103;if(v.status===103&&(v.gzhead.hcrc?(v.pending+2>v.pending_buf_size&&O(e),v.pending+2<=v.pending_buf_size&&(et(v,255&e.adler),et(v,e.adler>>8&255),e.adler=0,v.status=B)):v.status=B),v.pending!==0){if(O(e),e.avail_out===0)return v.last_flush=-1,c}else if(e.avail_in===0&&U(F)<=U(M)&&F!==_)return st(e,-5);if(v.status===666&&e.avail_in!==0)return st(e,-5);if(e.avail_in!==0||v.lookahead!==0||F!==y&&v.status!==666){var W=v.strategy===2?function(I,V){for(var J;;){if(I.lookahead===0&&(gt(I),I.lookahead===0)){if(V===y)return a;break}if(I.match_length=0,J=i._tr_tally(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++,J&&(R(I,!1),I.strm.avail_out===0))return a}return I.insert=0,V===_?(R(I,!0),I.strm.avail_out===0?nt:Z):I.last_lit&&(R(I,!1),I.strm.avail_out===0)?a:N}(v,F):v.strategy===3?function(I,V){for(var J,G,tt,pt,ct=I.window;;){if(I.lookahead<=Y){if(gt(I),I.lookahead<=Y&&V===y)return a;if(I.lookahead===0)break}if(I.match_length=0,I.lookahead>=z&&0<I.strstart&&(G=ct[tt=I.strstart-1])===ct[++tt]&&G===ct[++tt]&&G===ct[++tt]){pt=I.strstart+Y;do;while(G===ct[++tt]&&G===ct[++tt]&&G===ct[++tt]&&G===ct[++tt]&&G===ct[++tt]&&G===ct[++tt]&&G===ct[++tt]&&G===ct[++tt]&&tt<pt);I.match_length=Y-(pt-tt),I.match_length>I.lookahead&&(I.match_length=I.lookahead)}if(I.match_length>=z?(J=i._tr_tally(I,1,I.match_length-z),I.lookahead-=I.match_length,I.strstart+=I.match_length,I.match_length=0):(J=i._tr_tally(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++),J&&(R(I,!1),I.strm.avail_out===0))return a}return I.insert=0,V===_?(R(I,!0),I.strm.avail_out===0?nt:Z):I.last_lit&&(R(I,!1),I.strm.avail_out===0)?a:N}(v,F):n[v.level].func(v,F);if(W!==nt&&W!==Z||(v.status=666),W===a||W===nt)return e.avail_out===0&&(v.last_flush=-1),c;if(W===N&&(F===1?i._tr_align(v):F!==5&&(i._tr_stored_block(v,0,0,!1),F===3&&(it(v.head),v.lookahead===0&&(v.strstart=0,v.block_start=0,v.insert=0))),O(e),e.avail_out===0))return v.last_flush=-1,c}return F!==_?c:v.wrap<=0?1:(v.wrap===2?(et(v,255&e.adler),et(v,e.adler>>8&255),et(v,e.adler>>16&255),et(v,e.adler>>24&255),et(v,255&e.total_in),et(v,e.total_in>>8&255),et(v,e.total_in>>16&255),et(v,e.total_in>>24&255)):(Q(v,e.adler>>>16),Q(v,65535&e.adler)),O(e),0<v.wrap&&(v.wrap=-v.wrap),v.pending!==0?c:1)},u.deflateEnd=function(e){var F;return e&&e.state?(F=e.state.status)!==E&&F!==69&&F!==73&&F!==91&&F!==103&&F!==B&&F!==666?st(e,g):(e.state=null,F===B?st(e,-3):c):g},u.deflateSetDictionary=function(e,F){var M,v,w,A,P,W,I,V,J=F.length;if(!e||!e.state||(A=(M=e.state).wrap)===2||A===1&&M.status!==E||M.lookahead)return g;for(A===1&&(e.adler=o(e.adler,F,J,0)),M.wrap=0,J>=M.w_size&&(A===0&&(it(M.head),M.strstart=0,M.block_start=0,M.insert=0),V=new s.Buf8(M.w_size),s.arraySet(V,F,J-M.w_size,M.w_size,0),F=V,J=M.w_size),P=e.avail_in,W=e.next_in,I=e.input,e.avail_in=J,e.next_in=0,e.input=F,gt(M);M.lookahead>=z;){for(v=M.strstart,w=M.lookahead-(z-1);M.ins_h=(M.ins_h<<M.hash_shift^M.window[v+z-1])&M.hash_mask,M.prev[v&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=v,v++,--w;);M.strstart=v,M.lookahead=z-1,gt(M)}return M.strstart+=M.lookahead,M.block_start=M.strstart,M.insert=M.lookahead,M.lookahead=0,M.match_length=M.prev_length=z-1,M.match_available=0,e.next_in=W,e.input=I,e.avail_in=P,M.wrap=A,c},u.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,f,u){f.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,f,u){f.exports=function(n,s){var i,o,h,m,y,_,c,g,l,p,d,k,C,x,D,L,T,j,z,Y,rt,E,B,a,N;i=n.state,o=n.next_in,a=n.input,h=o+(n.avail_in-5),m=n.next_out,N=n.output,y=m-(s-n.avail_out),_=m+(n.avail_out-257),c=i.dmax,g=i.wsize,l=i.whave,p=i.wnext,d=i.window,k=i.hold,C=i.bits,x=i.lencode,D=i.distcode,L=(1<<i.lenbits)-1,T=(1<<i.distbits)-1;t:do{C<15&&(k+=a[o++]<<C,C+=8,k+=a[o++]<<C,C+=8),j=x[k&L];e:for(;;){if(k>>>=z=j>>>24,C-=z,(z=j>>>16&255)===0)N[m++]=65535&j;else{if(!(16&z)){if(!(64&z)){j=x[(65535&j)+(k&(1<<z)-1)];continue e}if(32&z){i.mode=12;break t}n.msg="invalid literal/length code",i.mode=30;break t}Y=65535&j,(z&=15)&&(C<z&&(k+=a[o++]<<C,C+=8),Y+=k&(1<<z)-1,k>>>=z,C-=z),C<15&&(k+=a[o++]<<C,C+=8,k+=a[o++]<<C,C+=8),j=D[k&T];r:for(;;){if(k>>>=z=j>>>24,C-=z,!(16&(z=j>>>16&255))){if(!(64&z)){j=D[(65535&j)+(k&(1<<z)-1)];continue r}n.msg="invalid distance code",i.mode=30;break t}if(rt=65535&j,C<(z&=15)&&(k+=a[o++]<<C,(C+=8)<z&&(k+=a[o++]<<C,C+=8)),c<(rt+=k&(1<<z)-1)){n.msg="invalid distance too far back",i.mode=30;break t}if(k>>>=z,C-=z,(z=m-y)<rt){if(l<(z=rt-z)&&i.sane){n.msg="invalid distance too far back",i.mode=30;break t}if(B=d,(E=0)===p){if(E+=g-z,z<Y){for(Y-=z;N[m++]=d[E++],--z;);E=m-rt,B=N}}else if(p<z){if(E+=g+p-z,(z-=p)<Y){for(Y-=z;N[m++]=d[E++],--z;);if(E=0,p<Y){for(Y-=z=p;N[m++]=d[E++],--z;);E=m-rt,B=N}}}else if(E+=p-z,z<Y){for(Y-=z;N[m++]=d[E++],--z;);E=m-rt,B=N}for(;2<Y;)N[m++]=B[E++],N[m++]=B[E++],N[m++]=B[E++],Y-=3;Y&&(N[m++]=B[E++],1<Y&&(N[m++]=B[E++]))}else{for(E=m-rt;N[m++]=N[E++],N[m++]=N[E++],N[m++]=N[E++],2<(Y-=3););Y&&(N[m++]=N[E++],1<Y&&(N[m++]=N[E++]))}break}}break}}while(o<h&&m<_);o-=Y=C>>3,k&=(1<<(C-=Y<<3))-1,n.next_in=o,n.next_out=m,n.avail_in=o<h?h-o+5:5-(o-h),n.avail_out=m<_?_-m+257:257-(m-_),i.hold=k,i.bits=C}},{}],49:[function(t,f,u){var n=t("../utils/common"),s=t("./adler32"),i=t("./crc32"),o=t("./inffast"),h=t("./inftrees"),m=1,y=2,_=0,c=-2,g=1,l=852,p=592;function d(E){return(E>>>24&255)+(E>>>8&65280)+((65280&E)<<8)+((255&E)<<24)}function k(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function C(E){var B;return E&&E.state?(B=E.state,E.total_in=E.total_out=B.total=0,E.msg="",B.wrap&&(E.adler=1&B.wrap),B.mode=g,B.last=0,B.havedict=0,B.dmax=32768,B.head=null,B.hold=0,B.bits=0,B.lencode=B.lendyn=new n.Buf32(l),B.distcode=B.distdyn=new n.Buf32(p),B.sane=1,B.back=-1,_):c}function x(E){var B;return E&&E.state?((B=E.state).wsize=0,B.whave=0,B.wnext=0,C(E)):c}function D(E,B){var a,N;return E&&E.state?(N=E.state,B<0?(a=0,B=-B):(a=1+(B>>4),B<48&&(B&=15)),B&&(B<8||15<B)?c:(N.window!==null&&N.wbits!==B&&(N.window=null),N.wrap=a,N.wbits=B,x(E))):c}function L(E,B){var a,N;return E?(N=new k,(E.state=N).window=null,(a=D(E,B))!==_&&(E.state=null),a):c}var T,j,z=!0;function Y(E){if(z){var B;for(T=new n.Buf32(512),j=new n.Buf32(32),B=0;B<144;)E.lens[B++]=8;for(;B<256;)E.lens[B++]=9;for(;B<280;)E.lens[B++]=7;for(;B<288;)E.lens[B++]=8;for(h(m,E.lens,0,288,T,0,E.work,{bits:9}),B=0;B<32;)E.lens[B++]=5;h(y,E.lens,0,32,j,0,E.work,{bits:5}),z=!1}E.lencode=T,E.lenbits=9,E.distcode=j,E.distbits=5}function rt(E,B,a,N){var nt,Z=E.state;return Z.window===null&&(Z.wsize=1<<Z.wbits,Z.wnext=0,Z.whave=0,Z.window=new n.Buf8(Z.wsize)),N>=Z.wsize?(n.arraySet(Z.window,B,a-Z.wsize,Z.wsize,0),Z.wnext=0,Z.whave=Z.wsize):(N<(nt=Z.wsize-Z.wnext)&&(nt=N),n.arraySet(Z.window,B,a-N,nt,Z.wnext),(N-=nt)?(n.arraySet(Z.window,B,a-N,N,0),Z.wnext=N,Z.whave=Z.wsize):(Z.wnext+=nt,Z.wnext===Z.wsize&&(Z.wnext=0),Z.whave<Z.wsize&&(Z.whave+=nt))),0}u.inflateReset=x,u.inflateReset2=D,u.inflateResetKeep=C,u.inflateInit=function(E){return L(E,15)},u.inflateInit2=L,u.inflate=function(E,B){var a,N,nt,Z,st,U,it,O,R,et,Q,X,gt,vt,lt,dt,wt,_t,At,Et,e,F,M,v,w=0,A=new n.Buf8(4),P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!E||!E.state||!E.output||!E.input&&E.avail_in!==0)return c;(a=E.state).mode===12&&(a.mode=13),st=E.next_out,nt=E.output,it=E.avail_out,Z=E.next_in,N=E.input,U=E.avail_in,O=a.hold,R=a.bits,et=U,Q=it,F=_;t:for(;;)switch(a.mode){case g:if(a.wrap===0){a.mode=13;break}for(;R<16;){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}if(2&a.wrap&&O===35615){A[a.check=0]=255&O,A[1]=O>>>8&255,a.check=i(a.check,A,2,0),R=O=0,a.mode=2;break}if(a.flags=0,a.head&&(a.head.done=!1),!(1&a.wrap)||(((255&O)<<8)+(O>>8))%31){E.msg="incorrect header check",a.mode=30;break}if((15&O)!=8){E.msg="unknown compression method",a.mode=30;break}if(R-=4,e=8+(15&(O>>>=4)),a.wbits===0)a.wbits=e;else if(e>a.wbits){E.msg="invalid window size",a.mode=30;break}a.dmax=1<<e,E.adler=a.check=1,a.mode=512&O?10:12,R=O=0;break;case 2:for(;R<16;){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}if(a.flags=O,(255&a.flags)!=8){E.msg="unknown compression method",a.mode=30;break}if(57344&a.flags){E.msg="unknown header flags set",a.mode=30;break}a.head&&(a.head.text=O>>8&1),512&a.flags&&(A[0]=255&O,A[1]=O>>>8&255,a.check=i(a.check,A,2,0)),R=O=0,a.mode=3;case 3:for(;R<32;){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}a.head&&(a.head.time=O),512&a.flags&&(A[0]=255&O,A[1]=O>>>8&255,A[2]=O>>>16&255,A[3]=O>>>24&255,a.check=i(a.check,A,4,0)),R=O=0,a.mode=4;case 4:for(;R<16;){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}a.head&&(a.head.xflags=255&O,a.head.os=O>>8),512&a.flags&&(A[0]=255&O,A[1]=O>>>8&255,a.check=i(a.check,A,2,0)),R=O=0,a.mode=5;case 5:if(1024&a.flags){for(;R<16;){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}a.length=O,a.head&&(a.head.extra_len=O),512&a.flags&&(A[0]=255&O,A[1]=O>>>8&255,a.check=i(a.check,A,2,0)),R=O=0}else a.head&&(a.head.extra=null);a.mode=6;case 6:if(1024&a.flags&&(U<(X=a.length)&&(X=U),X&&(a.head&&(e=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Array(a.head.extra_len)),n.arraySet(a.head.extra,N,Z,X,e)),512&a.flags&&(a.check=i(a.check,N,X,Z)),U-=X,Z+=X,a.length-=X),a.length))break t;a.length=0,a.mode=7;case 7:if(2048&a.flags){if(U===0)break t;for(X=0;e=N[Z+X++],a.head&&e&&a.length<65536&&(a.head.name+=String.fromCharCode(e)),e&&X<U;);if(512&a.flags&&(a.check=i(a.check,N,X,Z)),U-=X,Z+=X,e)break t}else a.head&&(a.head.name=null);a.length=0,a.mode=8;case 8:if(4096&a.flags){if(U===0)break t;for(X=0;e=N[Z+X++],a.head&&e&&a.length<65536&&(a.head.comment+=String.fromCharCode(e)),e&&X<U;);if(512&a.flags&&(a.check=i(a.check,N,X,Z)),U-=X,Z+=X,e)break t}else a.head&&(a.head.comment=null);a.mode=9;case 9:if(512&a.flags){for(;R<16;){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}if(O!==(65535&a.check)){E.msg="header crc mismatch",a.mode=30;break}R=O=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),E.adler=a.check=0,a.mode=12;break;case 10:for(;R<32;){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}E.adler=a.check=d(O),R=O=0,a.mode=11;case 11:if(a.havedict===0)return E.next_out=st,E.avail_out=it,E.next_in=Z,E.avail_in=U,a.hold=O,a.bits=R,2;E.adler=a.check=1,a.mode=12;case 12:if(B===5||B===6)break t;case 13:if(a.last){O>>>=7&R,R-=7&R,a.mode=27;break}for(;R<3;){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}switch(a.last=1&O,R-=1,3&(O>>>=1)){case 0:a.mode=14;break;case 1:if(Y(a),a.mode=20,B!==6)break;O>>>=2,R-=2;break t;case 2:a.mode=17;break;case 3:E.msg="invalid block type",a.mode=30}O>>>=2,R-=2;break;case 14:for(O>>>=7&R,R-=7&R;R<32;){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}if((65535&O)!=(O>>>16^65535)){E.msg="invalid stored block lengths",a.mode=30;break}if(a.length=65535&O,R=O=0,a.mode=15,B===6)break t;case 15:a.mode=16;case 16:if(X=a.length){if(U<X&&(X=U),it<X&&(X=it),X===0)break t;n.arraySet(nt,N,Z,X,st),U-=X,Z+=X,it-=X,st+=X,a.length-=X;break}a.mode=12;break;case 17:for(;R<14;){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}if(a.nlen=257+(31&O),O>>>=5,R-=5,a.ndist=1+(31&O),O>>>=5,R-=5,a.ncode=4+(15&O),O>>>=4,R-=4,286<a.nlen||30<a.ndist){E.msg="too many length or distance symbols",a.mode=30;break}a.have=0,a.mode=18;case 18:for(;a.have<a.ncode;){for(;R<3;){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}a.lens[P[a.have++]]=7&O,O>>>=3,R-=3}for(;a.have<19;)a.lens[P[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,M={bits:a.lenbits},F=h(0,a.lens,0,19,a.lencode,0,a.work,M),a.lenbits=M.bits,F){E.msg="invalid code lengths set",a.mode=30;break}a.have=0,a.mode=19;case 19:for(;a.have<a.nlen+a.ndist;){for(;dt=(w=a.lencode[O&(1<<a.lenbits)-1])>>>16&255,wt=65535&w,!((lt=w>>>24)<=R);){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}if(wt<16)O>>>=lt,R-=lt,a.lens[a.have++]=wt;else{if(wt===16){for(v=lt+2;R<v;){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}if(O>>>=lt,R-=lt,a.have===0){E.msg="invalid bit length repeat",a.mode=30;break}e=a.lens[a.have-1],X=3+(3&O),O>>>=2,R-=2}else if(wt===17){for(v=lt+3;R<v;){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}R-=lt,e=0,X=3+(7&(O>>>=lt)),O>>>=3,R-=3}else{for(v=lt+7;R<v;){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}R-=lt,e=0,X=11+(127&(O>>>=lt)),O>>>=7,R-=7}if(a.have+X>a.nlen+a.ndist){E.msg="invalid bit length repeat",a.mode=30;break}for(;X--;)a.lens[a.have++]=e}}if(a.mode===30)break;if(a.lens[256]===0){E.msg="invalid code -- missing end-of-block",a.mode=30;break}if(a.lenbits=9,M={bits:a.lenbits},F=h(m,a.lens,0,a.nlen,a.lencode,0,a.work,M),a.lenbits=M.bits,F){E.msg="invalid literal/lengths set",a.mode=30;break}if(a.distbits=6,a.distcode=a.distdyn,M={bits:a.distbits},F=h(y,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,M),a.distbits=M.bits,F){E.msg="invalid distances set",a.mode=30;break}if(a.mode=20,B===6)break t;case 20:a.mode=21;case 21:if(6<=U&&258<=it){E.next_out=st,E.avail_out=it,E.next_in=Z,E.avail_in=U,a.hold=O,a.bits=R,o(E,Q),st=E.next_out,nt=E.output,it=E.avail_out,Z=E.next_in,N=E.input,U=E.avail_in,O=a.hold,R=a.bits,a.mode===12&&(a.back=-1);break}for(a.back=0;dt=(w=a.lencode[O&(1<<a.lenbits)-1])>>>16&255,wt=65535&w,!((lt=w>>>24)<=R);){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}if(dt&&!(240&dt)){for(_t=lt,At=dt,Et=wt;dt=(w=a.lencode[Et+((O&(1<<_t+At)-1)>>_t)])>>>16&255,wt=65535&w,!(_t+(lt=w>>>24)<=R);){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}O>>>=_t,R-=_t,a.back+=_t}if(O>>>=lt,R-=lt,a.back+=lt,a.length=wt,dt===0){a.mode=26;break}if(32&dt){a.back=-1,a.mode=12;break}if(64&dt){E.msg="invalid literal/length code",a.mode=30;break}a.extra=15&dt,a.mode=22;case 22:if(a.extra){for(v=a.extra;R<v;){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}a.length+=O&(1<<a.extra)-1,O>>>=a.extra,R-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=23;case 23:for(;dt=(w=a.distcode[O&(1<<a.distbits)-1])>>>16&255,wt=65535&w,!((lt=w>>>24)<=R);){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}if(!(240&dt)){for(_t=lt,At=dt,Et=wt;dt=(w=a.distcode[Et+((O&(1<<_t+At)-1)>>_t)])>>>16&255,wt=65535&w,!(_t+(lt=w>>>24)<=R);){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}O>>>=_t,R-=_t,a.back+=_t}if(O>>>=lt,R-=lt,a.back+=lt,64&dt){E.msg="invalid distance code",a.mode=30;break}a.offset=wt,a.extra=15&dt,a.mode=24;case 24:if(a.extra){for(v=a.extra;R<v;){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}a.offset+=O&(1<<a.extra)-1,O>>>=a.extra,R-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){E.msg="invalid distance too far back",a.mode=30;break}a.mode=25;case 25:if(it===0)break t;if(X=Q-it,a.offset>X){if((X=a.offset-X)>a.whave&&a.sane){E.msg="invalid distance too far back",a.mode=30;break}gt=X>a.wnext?(X-=a.wnext,a.wsize-X):a.wnext-X,X>a.length&&(X=a.length),vt=a.window}else vt=nt,gt=st-a.offset,X=a.length;for(it<X&&(X=it),it-=X,a.length-=X;nt[st++]=vt[gt++],--X;);a.length===0&&(a.mode=21);break;case 26:if(it===0)break t;nt[st++]=a.length,it--,a.mode=21;break;case 27:if(a.wrap){for(;R<32;){if(U===0)break t;U--,O|=N[Z++]<<R,R+=8}if(Q-=it,E.total_out+=Q,a.total+=Q,Q&&(E.adler=a.check=a.flags?i(a.check,nt,Q,st-Q):s(a.check,nt,Q,st-Q)),Q=it,(a.flags?O:d(O))!==a.check){E.msg="incorrect data check",a.mode=30;break}R=O=0}a.mode=28;case 28:if(a.wrap&&a.flags){for(;R<32;){if(U===0)break t;U--,O+=N[Z++]<<R,R+=8}if(O!==(4294967295&a.total)){E.msg="incorrect length check",a.mode=30;break}R=O=0}a.mode=29;case 29:F=1;break t;case 30:F=-3;break t;case 31:return-4;case 32:default:return c}return E.next_out=st,E.avail_out=it,E.next_in=Z,E.avail_in=U,a.hold=O,a.bits=R,(a.wsize||Q!==E.avail_out&&a.mode<30&&(a.mode<27||B!==4))&&rt(E,E.output,E.next_out,Q-E.avail_out)?(a.mode=31,-4):(et-=E.avail_in,Q-=E.avail_out,E.total_in+=et,E.total_out+=Q,a.total+=Q,a.wrap&&Q&&(E.adler=a.check=a.flags?i(a.check,nt,Q,E.next_out-Q):s(a.check,nt,Q,E.next_out-Q)),E.data_type=a.bits+(a.last?64:0)+(a.mode===12?128:0)+(a.mode===20||a.mode===15?256:0),(et==0&&Q===0||B===4)&&F===_&&(F=-5),F)},u.inflateEnd=function(E){if(!E||!E.state)return c;var B=E.state;return B.window&&(B.window=null),E.state=null,_},u.inflateGetHeader=function(E,B){var a;return E&&E.state&&2&(a=E.state).wrap?((a.head=B).done=!1,_):c},u.inflateSetDictionary=function(E,B){var a,N=B.length;return E&&E.state?(a=E.state).wrap!==0&&a.mode!==11?c:a.mode===11&&s(1,B,N,0)!==a.check?-3:rt(E,B,N,N)?(a.mode=31,-4):(a.havedict=1,_):c},u.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,f,u){var n=t("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],i=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];f.exports=function(m,y,_,c,g,l,p,d){var k,C,x,D,L,T,j,z,Y,rt=d.bits,E=0,B=0,a=0,N=0,nt=0,Z=0,st=0,U=0,it=0,O=0,R=null,et=0,Q=new n.Buf16(16),X=new n.Buf16(16),gt=null,vt=0;for(E=0;E<=15;E++)Q[E]=0;for(B=0;B<c;B++)Q[y[_+B]]++;for(nt=rt,N=15;1<=N&&Q[N]===0;N--);if(N<nt&&(nt=N),N===0)return g[l++]=20971520,g[l++]=20971520,d.bits=1,0;for(a=1;a<N&&Q[a]===0;a++);for(nt<a&&(nt=a),E=U=1;E<=15;E++)if(U<<=1,(U-=Q[E])<0)return-1;if(0<U&&(m===0||N!==1))return-1;for(X[1]=0,E=1;E<15;E++)X[E+1]=X[E]+Q[E];for(B=0;B<c;B++)y[_+B]!==0&&(p[X[y[_+B]]++]=B);if(T=m===0?(R=gt=p,19):m===1?(R=s,et-=257,gt=i,vt-=257,256):(R=o,gt=h,-1),E=a,L=l,st=B=O=0,x=-1,D=(it=1<<(Z=nt))-1,m===1&&852<it||m===2&&592<it)return 1;for(;;){for(j=E-st,Y=p[B]<T?(z=0,p[B]):p[B]>T?(z=gt[vt+p[B]],R[et+p[B]]):(z=96,0),k=1<<E-st,a=C=1<<Z;g[L+(O>>st)+(C-=k)]=j<<24|z<<16|Y|0,C!==0;);for(k=1<<E-1;O&k;)k>>=1;if(k!==0?(O&=k-1,O+=k):O=0,B++,--Q[E]==0){if(E===N)break;E=y[_+p[B]]}if(nt<E&&(O&D)!==x){for(st===0&&(st=nt),L+=a,U=1<<(Z=E-st);Z+st<N&&!((U-=Q[Z+st])<=0);)Z++,U<<=1;if(it+=1<<Z,m===1&&852<it||m===2&&592<it)return 1;g[x=O&D]=nt<<24|Z<<16|L-l|0}}return O!==0&&(g[L+O]=E-st<<24|64<<16|0),d.bits=nt,0}},{"../utils/common":41}],51:[function(t,f,u){f.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,f,u){var n=t("../utils/common"),s=0,i=1;function o(w){for(var A=w.length;0<=--A;)w[A]=0}var h=0,m=29,y=256,_=y+1+m,c=30,g=19,l=2*_+1,p=15,d=16,k=7,C=256,x=16,D=17,L=18,T=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],j=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],rt=new Array(2*(_+2));o(rt);var E=new Array(2*c);o(E);var B=new Array(512);o(B);var a=new Array(256);o(a);var N=new Array(m);o(N);var nt,Z,st,U=new Array(c);function it(w,A,P,W,I){this.static_tree=w,this.extra_bits=A,this.extra_base=P,this.elems=W,this.max_length=I,this.has_stree=w&&w.length}function O(w,A){this.dyn_tree=w,this.max_code=0,this.stat_desc=A}function R(w){return w<256?B[w]:B[256+(w>>>7)]}function et(w,A){w.pending_buf[w.pending++]=255&A,w.pending_buf[w.pending++]=A>>>8&255}function Q(w,A,P){w.bi_valid>d-P?(w.bi_buf|=A<<w.bi_valid&65535,et(w,w.bi_buf),w.bi_buf=A>>d-w.bi_valid,w.bi_valid+=P-d):(w.bi_buf|=A<<w.bi_valid&65535,w.bi_valid+=P)}function X(w,A,P){Q(w,P[2*A],P[2*A+1])}function gt(w,A){for(var P=0;P|=1&w,w>>>=1,P<<=1,0<--A;);return P>>>1}function vt(w,A,P){var W,I,V=new Array(p+1),J=0;for(W=1;W<=p;W++)V[W]=J=J+P[W-1]<<1;for(I=0;I<=A;I++){var G=w[2*I+1];G!==0&&(w[2*I]=gt(V[G]++,G))}}function lt(w){var A;for(A=0;A<_;A++)w.dyn_ltree[2*A]=0;for(A=0;A<c;A++)w.dyn_dtree[2*A]=0;for(A=0;A<g;A++)w.bl_tree[2*A]=0;w.dyn_ltree[2*C]=1,w.opt_len=w.static_len=0,w.last_lit=w.matches=0}function dt(w){8<w.bi_valid?et(w,w.bi_buf):0<w.bi_valid&&(w.pending_buf[w.pending++]=w.bi_buf),w.bi_buf=0,w.bi_valid=0}function wt(w,A,P,W){var I=2*A,V=2*P;return w[I]<w[V]||w[I]===w[V]&&W[A]<=W[P]}function _t(w,A,P){for(var W=w.heap[P],I=P<<1;I<=w.heap_len&&(I<w.heap_len&&wt(A,w.heap[I+1],w.heap[I],w.depth)&&I++,!wt(A,W,w.heap[I],w.depth));)w.heap[P]=w.heap[I],P=I,I<<=1;w.heap[P]=W}function At(w,A,P){var W,I,V,J,G=0;if(w.last_lit!==0)for(;W=w.pending_buf[w.d_buf+2*G]<<8|w.pending_buf[w.d_buf+2*G+1],I=w.pending_buf[w.l_buf+G],G++,W===0?X(w,I,A):(X(w,(V=a[I])+y+1,A),(J=T[V])!==0&&Q(w,I-=N[V],J),X(w,V=R(--W),P),(J=j[V])!==0&&Q(w,W-=U[V],J)),G<w.last_lit;);X(w,C,A)}function Et(w,A){var P,W,I,V=A.dyn_tree,J=A.stat_desc.static_tree,G=A.stat_desc.has_stree,tt=A.stat_desc.elems,pt=-1;for(w.heap_len=0,w.heap_max=l,P=0;P<tt;P++)V[2*P]!==0?(w.heap[++w.heap_len]=pt=P,w.depth[P]=0):V[2*P+1]=0;for(;w.heap_len<2;)V[2*(I=w.heap[++w.heap_len]=pt<2?++pt:0)]=1,w.depth[I]=0,w.opt_len--,G&&(w.static_len-=J[2*I+1]);for(A.max_code=pt,P=w.heap_len>>1;1<=P;P--)_t(w,V,P);for(I=tt;P=w.heap[1],w.heap[1]=w.heap[w.heap_len--],_t(w,V,1),W=w.heap[1],w.heap[--w.heap_max]=P,w.heap[--w.heap_max]=W,V[2*I]=V[2*P]+V[2*W],w.depth[I]=(w.depth[P]>=w.depth[W]?w.depth[P]:w.depth[W])+1,V[2*P+1]=V[2*W+1]=I,w.heap[1]=I++,_t(w,V,1),2<=w.heap_len;);w.heap[--w.heap_max]=w.heap[1],function(ct,xt){var Yt,Rt,Ut,mt,Ft,ce,Dt=xt.dyn_tree,yr=xt.max_code,Pr=xt.stat_desc.static_tree,vr=xt.stat_desc.has_stree,$=xt.stat_desc.extra_bits,ft=xt.stat_desc.extra_base,kt=xt.stat_desc.max_length,St=0;for(mt=0;mt<=p;mt++)ct.bl_count[mt]=0;for(Dt[2*ct.heap[ct.heap_max]+1]=0,Yt=ct.heap_max+1;Yt<l;Yt++)kt<(mt=Dt[2*Dt[2*(Rt=ct.heap[Yt])+1]+1]+1)&&(mt=kt,St++),Dt[2*Rt+1]=mt,yr<Rt||(ct.bl_count[mt]++,Ft=0,ft<=Rt&&(Ft=$[Rt-ft]),ce=Dt[2*Rt],ct.opt_len+=ce*(mt+Ft),vr&&(ct.static_len+=ce*(Pr[2*Rt+1]+Ft)));if(St!==0){do{for(mt=kt-1;ct.bl_count[mt]===0;)mt--;ct.bl_count[mt]--,ct.bl_count[mt+1]+=2,ct.bl_count[kt]--,St-=2}while(0<St);for(mt=kt;mt!==0;mt--)for(Rt=ct.bl_count[mt];Rt!==0;)yr<(Ut=ct.heap[--Yt])||(Dt[2*Ut+1]!==mt&&(ct.opt_len+=(mt-Dt[2*Ut+1])*Dt[2*Ut],Dt[2*Ut+1]=mt),Rt--)}}(w,A),vt(V,pt,w.bl_count)}function e(w,A,P){var W,I,V=-1,J=A[1],G=0,tt=7,pt=4;for(J===0&&(tt=138,pt=3),A[2*(P+1)+1]=65535,W=0;W<=P;W++)I=J,J=A[2*(W+1)+1],++G<tt&&I===J||(G<pt?w.bl_tree[2*I]+=G:I!==0?(I!==V&&w.bl_tree[2*I]++,w.bl_tree[2*x]++):G<=10?w.bl_tree[2*D]++:w.bl_tree[2*L]++,V=I,pt=(G=0)===J?(tt=138,3):I===J?(tt=6,3):(tt=7,4))}function F(w,A,P){var W,I,V=-1,J=A[1],G=0,tt=7,pt=4;for(J===0&&(tt=138,pt=3),W=0;W<=P;W++)if(I=J,J=A[2*(W+1)+1],!(++G<tt&&I===J)){if(G<pt)for(;X(w,I,w.bl_tree),--G!=0;);else I!==0?(I!==V&&(X(w,I,w.bl_tree),G--),X(w,x,w.bl_tree),Q(w,G-3,2)):G<=10?(X(w,D,w.bl_tree),Q(w,G-3,3)):(X(w,L,w.bl_tree),Q(w,G-11,7));V=I,pt=(G=0)===J?(tt=138,3):I===J?(tt=6,3):(tt=7,4)}}o(U);var M=!1;function v(w,A,P,W){Q(w,(h<<1)+(W?1:0),3),function(I,V,J,G){dt(I),et(I,J),et(I,~J),n.arraySet(I.pending_buf,I.window,V,J,I.pending),I.pending+=J}(w,A,P)}u._tr_init=function(w){M||(function(){var A,P,W,I,V,J=new Array(p+1);for(I=W=0;I<m-1;I++)for(N[I]=W,A=0;A<1<<T[I];A++)a[W++]=I;for(a[W-1]=I,I=V=0;I<16;I++)for(U[I]=V,A=0;A<1<<j[I];A++)B[V++]=I;for(V>>=7;I<c;I++)for(U[I]=V<<7,A=0;A<1<<j[I]-7;A++)B[256+V++]=I;for(P=0;P<=p;P++)J[P]=0;for(A=0;A<=143;)rt[2*A+1]=8,A++,J[8]++;for(;A<=255;)rt[2*A+1]=9,A++,J[9]++;for(;A<=279;)rt[2*A+1]=7,A++,J[7]++;for(;A<=287;)rt[2*A+1]=8,A++,J[8]++;for(vt(rt,_+1,J),A=0;A<c;A++)E[2*A+1]=5,E[2*A]=gt(A,5);nt=new it(rt,T,y+1,_,p),Z=new it(E,j,0,c,p),st=new it(new Array(0),z,0,g,k)}(),M=!0),w.l_desc=new O(w.dyn_ltree,nt),w.d_desc=new O(w.dyn_dtree,Z),w.bl_desc=new O(w.bl_tree,st),w.bi_buf=0,w.bi_valid=0,lt(w)},u._tr_stored_block=v,u._tr_flush_block=function(w,A,P,W){var I,V,J=0;0<w.level?(w.strm.data_type===2&&(w.strm.data_type=function(G){var tt,pt=4093624447;for(tt=0;tt<=31;tt++,pt>>>=1)if(1&pt&&G.dyn_ltree[2*tt]!==0)return s;if(G.dyn_ltree[18]!==0||G.dyn_ltree[20]!==0||G.dyn_ltree[26]!==0)return i;for(tt=32;tt<y;tt++)if(G.dyn_ltree[2*tt]!==0)return i;return s}(w)),Et(w,w.l_desc),Et(w,w.d_desc),J=function(G){var tt;for(e(G,G.dyn_ltree,G.l_desc.max_code),e(G,G.dyn_dtree,G.d_desc.max_code),Et(G,G.bl_desc),tt=g-1;3<=tt&&G.bl_tree[2*Y[tt]+1]===0;tt--);return G.opt_len+=3*(tt+1)+5+5+4,tt}(w),I=w.opt_len+3+7>>>3,(V=w.static_len+3+7>>>3)<=I&&(I=V)):I=V=P+5,P+4<=I&&A!==-1?v(w,A,P,W):w.strategy===4||V===I?(Q(w,2+(W?1:0),3),At(w,rt,E)):(Q(w,4+(W?1:0),3),function(G,tt,pt,ct){var xt;for(Q(G,tt-257,5),Q(G,pt-1,5),Q(G,ct-4,4),xt=0;xt<ct;xt++)Q(G,G.bl_tree[2*Y[xt]+1],3);F(G,G.dyn_ltree,tt-1),F(G,G.dyn_dtree,pt-1)}(w,w.l_desc.max_code+1,w.d_desc.max_code+1,J+1),At(w,w.dyn_ltree,w.dyn_dtree)),lt(w),W&&dt(w)},u._tr_tally=function(w,A,P){return w.pending_buf[w.d_buf+2*w.last_lit]=A>>>8&255,w.pending_buf[w.d_buf+2*w.last_lit+1]=255&A,w.pending_buf[w.l_buf+w.last_lit]=255&P,w.last_lit++,A===0?w.dyn_ltree[2*P]++:(w.matches++,A--,w.dyn_ltree[2*(a[P]+y+1)]++,w.dyn_dtree[2*R(A)]++),w.last_lit===w.lit_bufsize-1},u._tr_align=function(w){Q(w,2,3),X(w,C,rt),function(A){A.bi_valid===16?(et(A,A.bi_buf),A.bi_buf=0,A.bi_valid=0):8<=A.bi_valid&&(A.pending_buf[A.pending++]=255&A.bi_buf,A.bi_buf>>=8,A.bi_valid-=8)}(w)}},{"../utils/common":41}],53:[function(t,f,u){f.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,f,u){(function(n){(function(s,i){if(!s.setImmediate){var o,h,m,y,_=1,c={},g=!1,l=s.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(s);p=p&&p.setTimeout?p:s,o={}.toString.call(s.process)==="[object process]"?function(x){process.nextTick(function(){k(x)})}:function(){if(s.postMessage&&!s.importScripts){var x=!0,D=s.onmessage;return s.onmessage=function(){x=!1},s.postMessage("","*"),s.onmessage=D,x}}()?(y="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",C,!1):s.attachEvent("onmessage",C),function(x){s.postMessage(y+x,"*")}):s.MessageChannel?((m=new MessageChannel).port1.onmessage=function(x){k(x.data)},function(x){m.port2.postMessage(x)}):l&&"onreadystatechange"in l.createElement("script")?(h=l.documentElement,function(x){var D=l.createElement("script");D.onreadystatechange=function(){k(x),D.onreadystatechange=null,h.removeChild(D),D=null},h.appendChild(D)}):function(x){setTimeout(k,0,x)},p.setImmediate=function(x){typeof x!="function"&&(x=new Function(""+x));for(var D=new Array(arguments.length-1),L=0;L<D.length;L++)D[L]=arguments[L+1];var T={callback:x,args:D};return c[_]=T,o(_),_++},p.clearImmediate=d}function d(x){delete c[x]}function k(x){if(g)setTimeout(k,0,x);else{var D=c[x];if(D){g=!0;try{(function(L){var T=L.callback,j=L.args;switch(j.length){case 0:T();break;case 1:T(j[0]);break;case 2:T(j[0],j[1]);break;case 3:T(j[0],j[1],j[2]);break;default:T.apply(i,j)}})(D)}finally{d(x),g=!1}}}}function C(x){x.source===s&&typeof x.data=="string"&&x.data.indexOf(y)===0&&k(+x.data.slice(y.length))}})(typeof self>"u"?n===void 0?this:n:self)}).call(this,typeof Pt<"u"?Pt:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Ii);var Mn=Ii.exports;const wr=Li(Mn);var Ri={exports:{}};(function(S,r){(function(t,f){f()})(Pt,function(){function t(h,m){return typeof m>"u"?m={autoBom:!1}:typeof m!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),m={autoBom:!m}),m.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(h.type)?new Blob(["\uFEFF",h],{type:h.type}):h}function f(h,m,y){var _=new XMLHttpRequest;_.open("GET",h),_.responseType="blob",_.onload=function(){o(_.response,m,y)},_.onerror=function(){console.error("could not download file")},_.send()}function u(h){var m=new XMLHttpRequest;m.open("HEAD",h,!1);try{m.send()}catch{}return 200<=m.status&&299>=m.status}function n(h){try{h.dispatchEvent(new MouseEvent("click"))}catch{var m=document.createEvent("MouseEvents");m.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),h.dispatchEvent(m)}}var s=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Pt=="object"&&Pt.global===Pt?Pt:void 0,i=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),o=s.saveAs||(typeof window!="object"||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(h,m,y){var _=s.URL||s.webkitURL,c=document.createElement("a");m=m||h.name||"download",c.download=m,c.rel="noopener",typeof h=="string"?(c.href=h,c.origin===location.origin?n(c):u(c.href)?f(h,m,y):n(c,c.target="_blank")):(c.href=_.createObjectURL(h),setTimeout(function(){_.revokeObjectURL(c.href)},4e4),setTimeout(function(){n(c)},0))}:"msSaveOrOpenBlob"in navigator?function(h,m,y){if(m=m||h.name||"download",typeof h!="string")navigator.msSaveOrOpenBlob(t(h,y),m);else if(u(h))f(h,m,y);else{var _=document.createElement("a");_.href=h,_.target="_blank",setTimeout(function(){n(_)})}}:function(h,m,y,_){if(_=_||open("","_blank"),_&&(_.document.title=_.document.body.innerText="downloading..."),typeof h=="string")return f(h,m,y);var c=h.type==="application/octet-stream",g=/constructor/i.test(s.HTMLElement)||s.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||c&&g||i)&&typeof FileReader<"u"){var p=new FileReader;p.onloadend=function(){var C=p.result;C=l?C:C.replace(/^data:[^;]*;/,"data:attachment/file;"),_?_.location.href=C:location=C,_=null},p.readAsDataURL(h)}else{var d=s.URL||s.webkitURL,k=d.createObjectURL(h);_?_.location=k:location.href=k,_=null,setTimeout(function(){d.revokeObjectURL(k)},4e4)}});s.saveAs=o.saveAs=o,S.exports=o})})(Ri);var xr=Ri.exports;function zn(S){const r=new DataView(S),t=r.getInt16(10),f=r.getInt16(12);if(t===0&&f===0){let u=r.getInt16(8);u&=-257,r.setInt16(8,u)}}async function Tn(S){return await Bn(S)??await Fn(S)}async function Bn(S){if(!S.name.endsWith(".zip"))return;const r=await wr.loadAsync(S);if(!Object.keys(r.files).some(n=>n.startsWith(".finf")||n.startsWith(".rsrc")))return;const t=S.name.slice(0,-4),f=Object.values(r.files).filter(n=>!n.dir&&n.name!=="DInfo"),u=await Promise.all(f.map(n=>n.async("blob")));return f.map((n,s)=>{const i=u[s],o=URL.createObjectURL(i);return{name:t+"/"+n.name,url:o,size:i.size}})}async function Fn(S){if(!S.name.endsWith(".zip"))return;const r=await wr.loadAsync(S),t=Object.values(r.files).filter(h=>!h.dir&&h.name.startsWith("__MACOSX"));if(!t.length)return;const f=S.name.slice(0,-4),u=Object.values(r.files).filter(h=>!h.dir&&!h.name.startsWith("__MACOSX")),n=u.every(h=>h.name.startsWith(f))?"":f+"/",s=await Promise.all(u.map(h=>h.async("blob"))),i=u.map((h,m)=>{const y=s[m],_=URL.createObjectURL(y);return{name:n+h.name,url:_,size:y.size}}),o=await Promise.all(t.map(h=>h.async("arraybuffer")));for(let h=0;h<t.length;h++){const m=t[h],y=o[h],_=m.name.split("/");_.shift();let c=_.pop();c.startsWith("._")&&(c=c.substring(2));const{resourceFork:g,metadata:l}=Ln(y,c);if(g){const p=URL.createObjectURL(g);i.push({name:n+[..._,".rsrc",c].join("/"),url:p,size:g.size})}if(l){const p=URL.createObjectURL(l);i.push({name:n+[..._,".finf",c].join("/"),url:p,size:l.size})}}return i}function Ln(S,r){const t=new DataView(S),f=t.getUint32(0);if(f!==333319)throw new Error(`Invalid AppleDouble magic ${f.toString(16)}`);const u=t.getUint32(4);if(u!==131072)throw new Error(`Invalid AppleDouble version ${u.toString(16)}`);const n=t.getUint16(24);let s=26,i,o;for(let h=0;h<n;h++){const m=t.getUint32(s),y=t.getUint32(s+4),_=t.getUint32(s+8);switch(m){case 2:i=new Blob([S.slice(y,y+_)]);break;case 9:{const c=S.slice(y,y+_);zn(c),o=new Blob([c]);break}default:console.log(`Ignoring unexpected entry ID ${m} found in ${r}`)}s+=12}return{resourceFork:i,metadata:o}}async function Nn(S){const r=new wr;function t(n,s,i){for(const o of i)if(Array.isArray(o.contents))t(n+"/"+o.name,s.folder(o.name),o.contents);else{const{contents:h}=o;s.file(o.name,h)}}t("",r,S.contents);const f=await r.generateAsync({compression:"DEFLATE",compressionOptions:{level:9},type:"blob"}),u=S.name+".zip";xr.saveAs(f,u),Qt("emulator_extractions")}const Pn={KeyA:0,KeyS:1,KeyD:2,KeyF:3,KeyH:4,KeyG:5,KeyZ:6,KeyX:7,KeyC:8,KeyV:9,KeyB:11,KeyQ:12,KeyW:13,KeyE:14,KeyR:15,KeyY:16,KeyT:17,Digit1:18,Digit2:19,Digit3:20,Digit4:21,Digit6:22,Digit5:23,Equal:24,Digit9:25,Digit7:26,Minus:27,Digit8:28,Digit0:29,BracketRight:30,KeyO:31,KeyU:32,BracketLeft:33,KeyI:34,KeyP:35,KeyL:37,KeyJ:38,Quote:39,KeyK:40,Semicolon:41,Backslash:42,Comma:43,Slash:44,KeyN:45,KeyM:46,Period:47,Backquote:50,NumpadDecimal:65,NumpadMultiply:67,NumpadAdd:69,NumLock:71,NumpadDivide:75,NumpadEnter:76,NumpadMinus:78,NumpadEqual:81,Numpad0:82,Numpad1:83,Numpad2:84,Numpad3:85,Numpad4:86,Numpad5:87,Numpad6:88,Numpad7:89,Numpad8:91,Numpad9:92,Enter:36,Tab:48,Space:49,Backspace:51,Escape:53,MetaLeft:55,OSLeft:55,ShiftLeft:56,CapsLock:57,AltLeft:58,ControlLeft:54,MetaRight:55,OSRight:55,ShiftRight:123,AltRight:124,ControlRight:125,Fn:114,F17:64,AudioVolumeUp:72,AudioVolumeDown:73,AudioVolumeMute:74,F18:79,F19:80,F20:90,F5:96,F6:97,F7:98,F3:99,F8:100,F9:101,F11:103,F13:105,F16:106,F14:107,F10:109,F12:111,F15:113,Help:114,Home:115,PageUp:116,Delete:117,F4:118,End:119,F2:120,PageDown:121,F1:122,ArrowLeft:59,ArrowRight:60,ArrowDown:61,ArrowUp:62},Un={ArrowLeft:123,ArrowRight:124,ArrowDown:125,ArrowUp:126,ShiftRight:56,AltRight:58,ControlLeft:59,ControlRight:59},jn={KeyA:57,KeyS:58,KeyD:59,KeyF:60,KeyH:64,KeyG:61,KeyZ:49,KeyX:50,KeyC:51,KeyV:52,KeyB:53,KeyQ:66,KeyW:67,KeyE:68,KeyR:69,KeyY:71,KeyT:72,Digit1:74,Digit2:75,Digit3:76,Digit4:77,Digit6:79,Digit5:80,Equal:28,Digit9:31,Digit7:78,Minus:29,Digit8:30,Digit0:32,BracketRight:4,KeyO:7,KeyU:70,BracketLeft:5,KeyI:6,KeyP:8,KeyL:45,KeyJ:63,Quote:43,KeyK:62,Semicolon:44,Backslash:3,Comma:46,Slash:48,KeyN:55,KeyM:54,Period:47,Backquote:38,NumpadDecimal:12,NumpadMultiply:37,NumpadAdd:21,NumLock:38,NumpadDivide:40,NumpadEnter:13,NumpadMinus:36,NumpadEqual:39,Numpad0:11,Numpad1:17,Numpad2:23,Numpad3:20,Numpad4:18,Numpad5:24,Numpad6:19,Numpad7:33,Numpad8:34,Numpad9:35,Enter:42,Tab:0,Space:56,Backspace:27,Escape:73,AudioVolumeUp:26,AudioVolumeDown:2,F5:2,F6:26,F10:88,Home:26,PageUp:25,Delete:88,F2:25,PageDown:1,F1:1,ArrowLeft:9,ArrowRight:16,ArrowDown:15,ArrowUp:22,End:2,MetaLeft:0,OSLeft:0,ShiftLeft:0,CapsLock:0,AltLeft:0,ControlLeft:0,MetaRight:0,OSRight:0,ShiftRight:0,AltRight:0,ControlRight:0,Fn:0,F3:0,F4:0,F7:0,F8:0,F9:0,F11:0,F12:0,F13:0,F15:0,F16:0,F14:0,F17:0,F18:0,F19:0,F20:0,AudioVolumeMute:0,Help:0},Wn=1522*10;var We,He;class Hn{constructor(){K(this,We,new SharedArrayBuffer(Wn));K(this,He,new ki(b(this,We),Uint8Array))}workerConfig(){return{type:"shared-memory",receiveBuffer:b(this,We)}}receive(r){const t=new Uint8Array(2);new DataView(t.buffer).setUint16(0,r.byteLength),b(this,He).push(t),b(this,He).push(r)}}We=new WeakMap,He=new WeakMap;var Ke;class Kn{constructor(r){K(this,Ke,void 0);q(this,Ke,r)}workerConfig(){return{type:"fallback"}}receive(r){b(this,Ke).call(this,{type:"ethernet_receive",packetArray:Array.from(r)})}}Ke=new WeakMap;var Ze,we,ye,te,Ge,zr;class Zn{constructor(r){K(this,Ze,void 0);K(this,we,void 0);K(this,ye,void 0);K(this,te,void 0);K(this,Ge,new Map);K(this,zr,()=>{if(!b(this,we)||!b(this,ye))return;const r=new Uint8Array(Wi),t=new DataView(r.buffer,r.byteOffset);r.set(Gn,0),r.set(b(this,we),6),t.setUint16(12,ji),r.set(ci,14),t.setUint32(14+ci.length,performance.now()),b(this,ye).send("*",r)});q(this,Ze,r)}start(r,t){q(this,we,Ni(r)),q(this,ye,t),q(this,te,window.setInterval(b(this,zr),location.host.startsWith("localhost")?500:5e3))}stop(){b(this,te)!==void 0&&(window.clearInterval(b(this,te)),q(this,te,void 0))}peers(){return Array.from(b(this,Ge).values())}handlePongPacket(r){if(r.byteLength!==Pi)return!1;for(let s=0;s<jr.length;s++)if(r[14+s]!==jr[s])return!1;const t=Ui(r.subarray(6,12)),u=new DataView(r.buffer,r.byteOffset).getUint32(14+jr.length),n=performance.now()-u;return b(this,Ge).set(t,{macAddress:t,rttMs:n,lastPingTimeMs:Date.now()}),b(this,Ze).ethernetPingerDidUpdatePeers(this),!0}}Ze=new WeakMap,we=new WeakMap,ye=new WeakMap,te=new WeakMap,Ge=new WeakMap,zr=new WeakMap;const Gn=[255,255,255,255,255,255],Hr=10240;var ve,Ve,Ye,Xe,Xr;class Vn{constructor(){K(this,Xe);K(this,ve,{});K(this,Ve,new SharedArrayBuffer(Hr));K(this,Ye,new Uint8Array(b(this,Ve)));ht(this,Xe,Xr).call(this)}workerConfig(){return{type:"shared-memory",clipboardBuffer:b(this,Ve),clipboardBufferSize:Hr}}setClipboardText(r){q(this,ve,{text:r}),ht(this,Xe,Xr).call(this)}}ve=new WeakMap,Ve=new WeakMap,Ye=new WeakMap,Xe=new WeakSet,Xr=function(){const r=JSON.stringify(b(this,ve)),t=new TextEncoder().encode(r);if(t.length>Hr){console.warn("Clipboard is too large, dropping"),q(this,ve,{});return}b(this,Ye).set(t),b(this,Ye).set([0],t.length)};var Qe;class Yn{constructor(r){K(this,Qe,void 0);q(this,Qe,r)}workerConfig(){return{type:"fallback"}}setClipboardText(r){b(this,Qe).call(this,{type:"set_clipboard_data",data:{text:r}})}}Qe=new WeakMap;const Xn="/assets/Device%20Image%20Header%20(All%20Drivers)-Bzrqc_Oa.hda";async function Qn(S,r){const t=await fetch(S.srcUrl);if(!t.ok){const o=await t.text();throw new Error(`Could not fetch CD-ROM, status=${t.status}, body=${o}`)}if(!t.body)throw new Error("Could not fetch CD-ROM, no response body");r(0);const f=t.body.getReader();let u=0;const n=new ReadableStream({async start(o){for(;;){const{done:h,value:m}=await f.read();if(h)break;u+=m.length,r(u/S.fileSize),o.enqueue(m)}o.close()}}),s=await new Response(n).blob();r(1);const i=URL.createObjectURL(s);return{...S,srcUrl:i}}var Mt,be,qe,Je,$e,tr,Tt,zt,ee;class qn{constructor(r){K(this,Mt,void 0);K(this,be,!1);K(this,qe,0);K(this,Je,0);K(this,$e,0);K(this,tr,0);K(this,Tt,!1);K(this,zt,0);K(this,ee,!1);q(this,Mt,r)}handlePointerDown(r){r.target&&"setPointerCapture"in r.target&&r.target.setPointerCapture(r.pointerId),q(this,be,!0),q(this,Tt,!1),q(this,qe,r.timeStamp),q(this,Je,r.clientX),q(this,$e,r.clientY)}handlePointerUp(r){q(this,be,!1),b(this,ee)?b(this,Tt)||(q(this,ee,!1),b(this,Mt).trackpadButtonUp(0)):b(this,Tt)||r.timeStamp-b(this,qe)<$n&&(b(this,zt)?(window.clearTimeout(b(this,zt)),q(this,zt,0),b(this,Mt).trackpadButtonUp(0),window.setTimeout(()=>b(this,Mt).trackpadButtonDown(0),33),window.setTimeout(()=>b(this,Mt).trackpadButtonUp(0),66)):(b(this,Mt).trackpadButtonDown(0),q(this,zt,window.setTimeout(()=>{b(this,Mt).trackpadButtonUp(0),q(this,zt,0)},ts)))),q(this,Tt,!1)}handlePointerMove(r){if(!b(this,be))return;const t=r.clientX-b(this,Je),f=r.clientY-b(this,$e);!b(this,Tt)&&t*t+f*f<Jn||(!b(this,ee)&&b(this,zt)&&(q(this,ee,!0),window.clearTimeout(b(this,zt)),q(this,zt,0)),b(this,Tt)?b(this,Mt).trackpadDidMove(...es(r.movementX,r.movementY,r.timeStamp-b(this,tr))):q(this,Tt,!0),q(this,tr,r.timeStamp))}}Mt=new WeakMap,be=new WeakMap,qe=new WeakMap,Je=new WeakMap,$e=new WeakMap,tr=new WeakMap,Tt=new WeakMap,zt=new WeakMap,ee=new WeakMap;const Jn=20*20,$n=200,ts=300;function es(S,r,t){const f=Math.sqrt(S*S+r*r)/t;if(f<=.5)return[S,r];if(f<=1)return[S*2,r*2];const n=Math.pow(f,2)/f;return[S*n,r*n]}var at,bt,Lt,ke,Nt,Zt,Gt,yt,Bt,Vt,re,Se,ie,Ee,er,ne,Ce,se,ae,oe,Ae,rr,Qr,ir,qr,nr,Jr,le,Ie,sr,ar,or,lr,cr,ur,hr,dr,$r,fr,ti,pr,mr,gr,_r,ei,Tr,Oi,Br,Mi,Fr,zi;class rs{constructor(r,t){K(this,rr);K(this,ir);K(this,nr);K(this,le);K(this,dr);K(this,fr);K(this,_r);K(this,Tr);K(this,Br);K(this,Fr);K(this,at,void 0);K(this,bt,void 0);K(this,Lt,void 0);K(this,ke,!1);K(this,Nt,void 0);K(this,Zt,void 0);K(this,Gt,void 0);K(this,yt,void 0);K(this,Bt,void 0);K(this,Vt,void 0);K(this,re,void 0);K(this,Se,void 0);K(this,ie,void 0);K(this,Ee,void 0);K(this,er,!1);K(this,ne,void 0);K(this,Ce,new Set);K(this,se,0);K(this,ae,0);K(this,oe,void 0);K(this,Ae,!1);K(this,sr,r=>{ht(this,le,Ie).call(this)?b(this,oe).handlePointerMove(r):(q(this,se,r.offsetX),q(this,ae,r.offsetY),b(this,yt).handleInput({type:"mousemove",x:r.offsetX,y:r.offsetY,deltaX:r.movementX,deltaY:r.movementY}))});K(this,ar,r=>{if(ht(this,le,Ie).call(this)){b(this,oe).handlePointerDown(r);return}q(this,se,r.offsetX),q(this,ae,r.offsetY);const t=()=>{b(this,yt).handleInput({type:"mousedown",button:r.button})};gi?t():(b(this,yt).handleInput({type:"mousemove",x:r.offsetX,y:r.offsetY,deltaX:r.movementX,deltaY:r.movementY}),setTimeout(t,16)),ht(this,nr,Jr).call(this)&&!b(this,Ae)&&(b(this,at).screenCanvas.requestPointerLock({unadjustedMovement:!1}),q(this,Ae,!0))});K(this,or,r=>{document.pointerLockElement||q(this,Ae,!1)});K(this,lr,r=>{ht(this,le,Ie).call(this)?b(this,oe).handlePointerUp(r):b(this,yt).handleInput({type:"mouseup",button:r.button})});K(this,cr,r=>{r.preventDefault()});K(this,ur,r=>{const{target:t,code:f}=r;if(t instanceof HTMLInputElement&&!t.classList.contains("Mac-Keyboard-Input"))return;r.preventDefault();const u=ht(this,dr,$r).call(this,f);u!==void 0?(b(this,Ce).add(f),f==="KeyV"&&r.metaKey&&navigator.clipboard.readText().then(n=>b(this,Se).setClipboardText(n),n=>console.error("Could not read clipboard",n)),b(this,yt).handleInput({type:"keydown",keyCode:u,modifiers:ht(this,fr,ti).call(this,r)})):console.warn(`Unhandled key: ${f}`)});K(this,hr,r=>{const{code:t}=r,f=u=>{b(this,Ce).delete(u);const n=ht(this,dr,$r).call(this,u);n!==void 0&&b(this,yt).handleInput({type:"keyup",keyCode:n,modifiers:ht(this,fr,ti).call(this,r)})};if(f(t),t.startsWith("Meta")&&navigator.platform.startsWith("Mac"))for(const u of b(this,Ce))!u.startsWith("Meta")&&!u.startsWith("Control")&&!u.startsWith("Alt")&&!u.startsWith("Shift")&&f(u)});K(this,pr,()=>{this.stop()});K(this,mr,r=>{var t,f,u,n,s,i,o,h,m,y,_,c,g;if(r.data.type==="emulator_ready")(f=(t=b(this,bt))==null?void 0:t.emulatorDidFinishLoading)==null||f.call(t,this);else if(r.data.type==="emulator_video_open"){console.log(`Initializing video (${r.data.width}x${r.data.height})`);const{width:l,height:p}=r.data;q(this,Zt,b(this,Nt).createImageData(l,p)),(n=(u=b(this,bt))==null?void 0:u.emulatorDidChangeScreenSize)==null||n.call(u,l,p)}else if(r.data.type==="emulator_audio_open"){const{sampleRate:l,sampleSize:p,channels:d}=r.data;b(this,Bt).init(l,p,d,b(this,at).debugAudio??!1)}else if(r.data.type==="emulator_blit"){b(this,er)||(q(this,er,!0),console.timeEnd("Emulator first blit"));const l=r.data.data;b(this,Gt).blit(l),ht(this,_r,ei).call(this)}else if(r.data.type==="emulator_audio")b(this,Bt)instanceof fi&&b(this,Bt).handleData(r.data.data);else if(r.data.type==="emulator_extract_directory")Nn(r.data.extraction);else if(r.data.type==="emulator_quiescent")console.timeEnd("Emulator quiescent");else if(r.data.type==="emulator_stopped")ht(this,Fr,zi).call(this,r.data.isExit);else if(r.data.type==="emulator_ethernet_init"){const{ethernetProvider:l}=b(this,at);l&&(l.init(r.data.macAddress),b(this,ne).start(r.data.macAddress,l))}else if(r.data.type==="emulator_ethernet_write"){const{destination:l,packet:p}=r.data,d=void 0;d?b(this,re).receive(d):(s=b(this,at).ethernetProvider)==null||s.send(l,p)}else if(r.data.type==="emulator_set_clipboard_text"){const{text:l}=r.data;navigator.clipboard.writeText(l).then(()=>{},p=>{console.error("Could not set clipboard text:",p)})}else r.data.type==="emulator_did_run_out_memory"?(o=(i=b(this,bt))==null?void 0:i.emulatorDidRunOutOfMemory)==null||o.call(i,this):r.data.type==="emulator_did_have_error"?(m=(h=b(this,bt))==null?void 0:h.emulatorDidHaveError)==null||m.call(h,this,r.data.error,r.data.errorRaw??r.data.error):r.data.type==="emulator_will_load_chunk"?(_=(y=b(this,bt))==null?void 0:y.emulatorDidStartToLoadDiskChunk)==null||_.call(y,this):r.data.type==="emulator_did_load_chunk"?(g=(c=b(this,bt))==null?void 0:c.emulatorDidFinishLoadingDiskChunk)==null||g.call(c,this):console.warn("Unexpected postMessage event",r)});K(this,gr,()=>{ht(this,_r,ei).call(this)});var o;console.time("Emulator first blit"),console.time("Emulator quiescent"),q(this,at,r),q(this,bt,t),q(this,Lt,new di);const{useSharedMemory:f,screenCanvas:u,screenWidth:n,screenHeight:s}=b(this,at);ht(this,Br,Mi).call(this);let i;f||(i=async h=>{await b(this,Ee)?b(this,ie).postMessage({type:"worker-command",command:h}):console.error("Service worker is not available, cannot send command",h)}),q(this,Nt,u.getContext("2d",{desynchronized:!0})),q(this,Zt,b(this,Nt).createImageData(n,s)),q(this,Gt,f?new Dn(r):new In(r)),q(this,yt,f?new En:new xn(i)),q(this,Bt,f?new Sn(b(this,yt)):new fi(b(this,yt))),q(this,Vt,f?new Rn:new On(i)),q(this,re,f?new Hn:new Kn(i)),(o=r.ethernetProvider)==null||o.setDelegate({receive:h=>{b(this,ne).handlePongPacket(h)||(b(this,re).receive(h),b(this,yt).handleInput({type:"ethernet-interrupt"}))}}),q(this,ne,new Zn({ethernetPingerDidUpdatePeers:h=>{var m,y;(y=(m=b(this,bt))==null?void 0:m.emulatorEthernetPeersDidChange)==null||y.call(m,this,h.peers())}})),q(this,Se,f?new Vn:new Yn(i)),q(this,oe,new qn({trackpadDidMove:(h,m)=>{b(this,yt).handleInput({type:"mousemove",x:b(this,se),y:b(this,ae),deltaX:h,deltaY:m}),q(this,se,b(this,se)+h),q(this,ae,b(this,ae)+m)},trackpadButtonDown:h=>{b(this,yt).handleInput({type:"mousedown",button:h})},trackpadButtonUp:h=>{b(this,yt).handleInput({type:"mouseup",button:h})}}))}async start(){const{screenCanvas:r}=b(this,at);r.addEventListener("pointermove",b(this,sr)),r.addEventListener("pointerdown",b(this,ar)),r.addEventListener("pointerup",b(this,lr)),r.addEventListener("touchstart",b(this,cr)),window.addEventListener("keydown",b(this,ur)),window.addEventListener("keyup",b(this,hr)),window.addEventListener("beforeunload",b(this,pr)),document.addEventListener("visibilitychange",b(this,gr)),document.addEventListener("pointerlockchange",b(this,or)),await ht(this,rr,Qr).call(this)}refreshSettings(){var u,n;const r=(n=(u=b(this,bt))==null?void 0:u.emulatorSettings)==null?void 0:n.call(u,this),t=r==null?void 0:r.speed;t!==void 0&&b(this,yt).handleInput({type:"set-speed",speed:t});const f=ht(this,le,Ie).call(this)||(r==null?void 0:r.useMouseDeltas);f!==void 0&&b(this,yt).handleInput({type:"set-use-mouse-deltas",useMouseDeltas:f})}stop(){const{screenCanvas:r}=b(this,at);r.removeEventListener("pointermove",b(this,sr)),r.removeEventListener("pointerdown",b(this,ar)),r.removeEventListener("pointerup",b(this,lr)),r.removeEventListener("touchstart",b(this,cr)),window.removeEventListener("keydown",b(this,ur)),window.removeEventListener("keyup",b(this,hr)),window.removeEventListener("beforeunload",b(this,pr)),document.removeEventListener("visibilitychange",b(this,gr)),document.addEventListener("pointerlockchange",b(this,or)),b(this,yt).handleInput({type:"stop"}),b(this,ne).stop(),b(this,Bt).stop()}restart(r){return b(this,Bt).stop(),b(this,yt).handleInput({type:"stop"}),new Promise(t=>{const f=setInterval(()=>{if(b(this,ke)){ht(this,Tr,Oi).call(this),clearInterval(f);const u=()=>{ht(this,rr,Qr).call(this),b(this,yt).handleInput({type:"start"}),t()};r?r().then(u):u()}},100)})}async uploadFiles(r,t=[]){const f=[],u=[];for(let n=0;n<r.length;n++){const s=r[n],i=await Tn(s);if(i){b(this,Vt).uploadFiles(i);continue}f.push(s),u.push(t[n])}f.length&&b(this,Vt).uploadFiles(f.map((n,s)=>({name:u[s]??n.name,url:URL.createObjectURL(n),size:n.size})))}async loadCDROM(r){const t=await ht(this,ir,qr).call(this,[r]);b(this,Vt).loadCDROM(t[0])}}at=new WeakMap,bt=new WeakMap,Lt=new WeakMap,ke=new WeakMap,Nt=new WeakMap,Zt=new WeakMap,Gt=new WeakMap,yt=new WeakMap,Bt=new WeakMap,Vt=new WeakMap,re=new WeakMap,Se=new WeakMap,ie=new WeakMap,Ee=new WeakMap,er=new WeakMap,ne=new WeakMap,Ce=new WeakMap,se=new WeakMap,ae=new WeakMap,oe=new WeakMap,Ae=new WeakMap,rr=new WeakSet,Qr=async function(){var C;b(this,ke)&&q(this,Lt,new di),b(this,Lt).addEventListener("message",b(this,mr));const r=vn(b(this,at).machine);let t={};for(const x of[...b(this,at).disks,...b(this,at).delayedDisks??[]])t={...t,...(C=x.extraMachineFiles)==null?void 0:C.get(b(this,at).machine)};const[f,u,n,s,...i]=await is([r,b(this,at).machine.romPath,b(this,at).machine.prefsPath,Xn,...Object.values(t)],(x,D)=>{var L,T;(T=(L=b(this,bt))==null?void 0:L.emulatorDidMakeLoadingProgress)==null||T.call(L,this,x,D)}),o=b(this,at).machine.romPath.split("/"),h=o[o.length-1],m=await mi(b(this,at).disks),y=b(this,at).delayedDisks?await mi(b(this,at).delayedDisks):void 0,_={};Object.keys(t).forEach((x,D)=>{_[x]=i[D]});let c=[],g;const{emulatorType:l}=b(this,at).machine;if(l==="DingusPPC")c=ss(b(this,at),{disks:m,romFileName:h}),g=c.join(" ");else if(l==="Previous"){const x=as(b(this,at),{baseConfig:n,disks:m,romFileName:h});_["previous.cfg"]=new TextEncoder().encode(x).buffer;for(const D of[...m,...y??[],...b(this,at).cdroms,...b(this,at).diskFiles])_[D.name]=new ArrayBuffer(0);g=x}else{const x=ns(b(this,at),{basePrefs:n,disks:m,romFileName:h});c=["--config","prefs"],_.prefs=new TextEncoder().encode(x).buffer,g=x}console.groupCollapsed("%cGenerated emulator config","font-weight: normal"),console.log(g),console.groupEnd();const p=b(this,at).customDate?b(this,at).customDate.getTime()-Date.now():0,d={emulatorType:b(this,at).machine.emulatorType,emulatorSubtype:b(this,at).machine.emulatorSubtype,wasm:f,disks:m,delayedDisks:y,diskFiles:b(this,at).diskFiles,deviceImageHeader:s,cdroms:await ht(this,ir,qr).call(this,b(this,at).cdroms),usePlaceholderDisks:wi(l),autoloadFiles:{[h]:u,..._},arguments:c,video:b(this,Gt).workerConfig(),input:b(this,yt).workerConfig(),audio:b(this,Bt).workerConfig(),files:b(this,Vt).workerConfig(),ethernet:b(this,re).workerConfig(),clipboard:b(this,Se).workerConfig(),dateOffset:p};if(await b(this,Ee))for(const x of d.disks.concat(d.delayedDisks??[]))b(this,ie).postMessage({type:"init-disk-cache",spec:x});else console.warn("Could not initialize service worker, things will be slower");b(this,Lt).postMessage({type:"start",config:d},[f,u,s,...Object.values(_)])},ir=new WeakSet,qr=async function(r){const t=[];for(const f of r)f.fetchClientSide?t.push(await Qn(f,u=>{var n,s;(s=(n=b(this,bt))==null?void 0:n.emulatorDidMakeCDROMLoadingProgress)==null||s.call(n,this,f,u)})):t.push(f);return t},nr=new WeakSet,Jr=function(){var t,f;const{emulatorType:r}=b(this,at).machine;return yi(r)||((f=(t=b(this,bt))==null?void 0:t.emulatorSettings)==null?void 0:f.call(t,this).useMouseDeltas)===!0&&vi(r)},le=new WeakSet,Ie=function(){var r,t;return ht(this,nr,Jr).call(this)&&!gi?!0:((t=(r=b(this,bt))==null?void 0:r.emulatorSettings)==null?void 0:t.call(r,this).trackpadMode)??b(this,at).debugTrackpad??!1},sr=new WeakMap,ar=new WeakMap,or=new WeakMap,lr=new WeakMap,cr=new WeakMap,ur=new WeakMap,hr=new WeakMap,dr=new WeakSet,$r=function(r){var t,f;if((f=(t=b(this,bt))==null?void 0:t.emulatorSettings)!=null&&f.call(t,this).swapControlAndCommand&&(r.startsWith("Control")?r="Meta"+r.slice(7):r.startsWith("Meta")&&(r="Control"+r.slice(4))),b(this,at).machine.emulatorType==="Previous")return jn[r];if(b(this,at).machine.emulatorType==="Mini vMac"){const u=Un[r];if(u!==void 0)return u}return Pn[r]},fr=new WeakSet,ti=function(r){var f,u;if(b(this,at).machine.emulatorType!=="Previous")return;let t=0;return r.altKey&&(t|=32),r.shiftKey&&(t|=2),(u=(f=b(this,bt))==null?void 0:f.emulatorSettings)!=null&&u.call(f,this).swapControlAndCommand?(r.ctrlKey&&(t|=8),r.metaKey&&(t|=1)):(r.ctrlKey&&(t|=1),r.metaKey&&(t|=8)),t},pr=new WeakMap,mr=new WeakMap,gr=new WeakMap,_r=new WeakSet,ei=function(){if(document.hidden)return;const r=b(this,Gt).imageData();if(!r)return;b(this,Zt).data.set(r);const t=b(this,Gt).consumeBlitRect();t?b(this,Nt).putImageData(b(this,Zt),0,0,t.left,t.top,t.right-t.left,t.bottom-t.top):b(this,Nt).putImageData(b(this,Zt),0,0)},Tr=new WeakSet,Oi=function(){b(this,Nt).clearRect(0,0,b(this,at).screenCanvas.width,b(this,at).screenCanvas.height)},Br=new WeakSet,Mi=function(){if(!("serviceWorker"in navigator)){console.warn("Service workers not available");return}const r="classic";q(this,Ee,new Promise((t,f)=>{navigator.serviceWorker.register(bn,{scope:"/",type:r}).then(u=>{const n=i=>{q(this,ie,i),i.addEventListener("statechange",s)},s=i=>{const{state:o}=b(this,ie);console.log(`Service worker stage changed to "${o}"`),o==="activated"&&t(!0)};console.log("Service worker registered"),u.installing?(console.log("Service worker installing"),n(u.installing)):u.waiting?(console.log("Service worker installed, waiting"),n(u.waiting)):u.active&&(console.log("Service worker active"),n(u.active),t(!0))}).catch(u=>{console.error("Service worker error",u),t(!1)})}))},Fr=new WeakSet,zi=async function(r){var t,f;b(this,Lt).removeEventListener("message",b(this,mr)),b(this,Lt).terminate(),q(this,ke,!0),r&&((f=(t=b(this,bt))==null?void 0:t.emulatorDidExit)==null||f.call(t,this))};async function is(S,r){let t=S.length;r(S.length,t);const f=[];return await Promise.all(S.map(async(u,n)=>{const s=await fetch(u);f[n]=await s.arrayBuffer(),r(S.length,--t)})),f}async function mi(S){const r=await Promise.all(S.map(t=>t.generatedSpec().then(f=>f.default)));return S.map((t,f)=>({...r[f],baseUrl:"/Disk",prefetchChunks:t.prefetchChunks,persistent:t.persistent,isFloppy:t.isFloppy,hasDeviceImageHeader:t.hasDeviceImageHeader}))}function ns(S,{basePrefs:r,romFileName:t,disks:f}){const{machine:u}=S;let n=new TextDecoder().decode(r);n+=`rom ${t}
`;const s=Hi(u.emulatorType,u.cpu);s!==void 0&&(n+=`cpu ${s}
`);const i=Ki(u.emulatorType,u.gestaltID);i!==void 0&&(n+=`modelid ${i}
`);const o=S.ramSize??u.ramSizes[0];let h=parseInt(o);o.endsWith("M")?h*=1024*1024:o.endsWith("K")&&(h*=1024),n+=`ramsize ${h}
`,n+=`screen win/${S.screenWidth}/${S.screenHeight}
`;for(const m of f)n+=`disk ${m.name}
`;for(const m of S.cdroms)n+=`disk ${m.mountReadWrite?"":"*"}${m.name}
`;for(const m of S.diskFiles)m.isCDROM?n+=`cdrom ${m.name}
`:n+=`disk ${m.name}
`;if(wi(u.emulatorType))for(let m=0;m<Zi;m++)n+=`disk */placeholder/${m}
`;return S.ethernetProvider&&(n+=`appletalk true
`),n+=`jsfrequentreadinput ${S.useSharedMemory}
`,n}function ss(S,{romFileName:r,disks:t}){const f=["--realtime","--bootrom",r];S.debugLog&&f.push("--log-to-stderr","--log-no-uptime","--log-to-stderr-verbose");const u=[],n=[],s=[];for(const o of t)o.isFloppy?u.push(o.name):n.push(o.name);for(const o of S.cdroms)s.push(o.name);for(const o of S.diskFiles)o.isCDROM?s.push(o.name):n.push(o.name);u.length>0&&(f.push("--fdd_img",u[0]),f.push("--fdd_wr_prot=1")),n.length>0&&(S.machine.gestaltID!==Gi.gestaltID?f.push("--hdd_img",n.join(":")):f.push("--hdd_img",n[0])),s.length>0&&f.push("--cdr_img",s[0]);const i=S.ramSize??S.machine.ramSizes[0];switch(S.machine.gestaltID){case Vi.gestaltID:{const o=Math.floor((parseInt(i)-8)/2).toString();f.push("--rambank1_size",o),f.push("--rambank2_size",o);break}default:f.push("--rambank1_size",i.slice(0,-1));break}switch(S.machine.gestaltID){case Yi.gestaltID:f.push("--machine","pm7500");break}return f}function as(S,{baseConfig:r,romFileName:t,disks:f}){const u=[],n=[];function s(l,p,d,k=!0){const C=l.length;l.push(`
szImageName${C} = ${p}
nDeviceType${C} = ${d?2:1}
bDiskInserted${C} = ${k?"TRUE":"FALSE"}
bWriteProtected${C} = ${d?"TRUE":"FALSE"}
`)}for(const l of f)s(l.isFloppy?u:n,l.name,!1);for(const l of S.diskFiles)s(n,l.name,l.isCDROM);for(const l of S.cdroms){const p=n.length>0;s(n,l.name,p)}s(n,"/",!0,!1);let i=1;S.cdroms.length+S.disks.length+S.diskFiles.length===0?i=0:f.length===1&&f[0].isFloppy&&(i=4);const{machine:o}=S,h=o.emulatorSubtype==="NeXTstation Turbo Color",m={MACHINE_TYPE:o.gestaltID,ROM_PATH:t,FLOPPIES:u.join(`
`),DISKS:n.join(`
`),DEBUG_LOG:S.debugLog??!1,BOOT_DEVICE:i,TURBO:h,COLOR:h,CPU_LEVEL:o.cpu==="68040"?4:3,CPU_FREQ:h?40:25,FPU_TYPE:o.cpu==="68040"?"68040":"68882",DSP_TYPE:2,DSP_MEMORY_EXPANSION:o.emulatorSubtype!=="NeXT Computer",SCSI_CHIP:o.emulatorSubtype!=="NeXT Computer",RTC_CHIP:h,NBIC:o.emulatorSubtype==="NeXT Computer"||o.emulatorSubtype==="NeXTcube"},y=S.ramSize??S.machine.ramSizes[0],_={"128M":[32,32,32,32],"64M":h?[32,32,0,0]:[16,16,16,16],"32M":h?[8,8,8,8]:[16,16,0,0],"16M":h?[8,8,0,0]:[16,0,0,0]};(y in _?_[y]:_["128M"]).forEach((l,p)=>m[`RAM_BANK_SIZE${p}`]=l);let g=new TextDecoder().decode(r);for(const[l,p]of Object.entries(m)){const d=typeof p=="boolean"?p?"TRUE":"FALSE":p.toString();g=g.replaceAll(`{${l}}`,d)}return g}const gi="matchMedia"in window&&window.matchMedia("(hover: hover)").matches;function os(){const S=window.devicePixelRatio,[r,t]=ot.useState(S);return ot.useEffect(()=>{const f=()=>t(window.devicePixelRatio),u=window.matchMedia(`screen and (resolution: ${r}dppx)`);return u.addEventListener?u.addEventListener("change",f):u.addListener(f),()=>{u.removeEventListener?u.removeEventListener("change",f):u.removeListener(f)}},[r]),r}const ls="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAALVBMVEUAAAD//////9rz8/Oy///n5+fa2v/a2trNzc2zs///h9qlpaWzhrRmZmazAIeaWgbrAAAAAXRSTlMAQObYZgAAARNJREFUeNqN09GOgzAMRNFCOrYpTf//c9ee9QgQK22Th0rcUwce8jiv2etxW12j11+G1fHBKzfNtWeGmb1bGGLMa19hyE7hBgws89SxooQmsLfQ/ykMFLDsFOpPtGB3TcCYDSABCrPuMdUljMJH1dwowRMkBies6gIbJKKWswOwBOy+gebWKWYgBU3Wfc59gVfdahPkL2iy18jdw7bePaF36LOin2jC6H2AoWcEvvUO/z2iJ9zeAY5ln9Xv78A6sMCjFuz0FSUcwLmveJZhJ8jKPgwvvLGWoBFQR/aPRG19VtbuFAaJ7AXUYdX9fYgEFMt1ggS7BLupUwS7hLrOMHWJEThOSBHql6snwav37eX99/r/ACfaFe9X9xynAAAAAElFTkSuQmCC",cs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAIc0lEQVR42sVXPYscuRbVX6hhwWAmMMKwgWETBWYyB0rmBygyL9lA2QQDy7tph9pkgs5usImZSJlZaHgocGKGCeoHGJqKBhaDGf2F++4tVbe6pqvc5Q/ekzk+o5qu6XPu0VWp1M8apFQTKZoPqw/27uEOHx4esG3bKJD53d0dyu9jjGZ03wdliRSq/9doqXWfP39O28fH3HUdtV1L9/e3ebNZMdaFGbf365xSotQm2mzu87v/vEuIrVutVppI6f+5cOIKP9JjZtUsmIWuLnMATQKAhoJvmBWBV+SFgedBoAnQEEZPMSJtbjc5xhuMzpmfqa9RxHgyJ6LmgR4w50zb7SYn9ITBEIIR4cyaudmZEOzF+0G8R81sCISROVrCCAykm5uI9Xt/8iAiyxUX5XmzvswJLEUWEqE3UE14zTxOAJ4kUMUbCjuOjgG0Xq8zLyv7E5Wr5uGB+qrfr1c5BUcJHItnA2AJj03UBPwogZH4AjuIZ06WQnIEjBACXd9co1LU/GjVG0Z8fNzm7epqLz6x+D6BAQiDibqMTvSAlspX8YxjE0CcRKTvNbGilf5C1H359LFrg6eWxQsfJlCXkR31wskeGMTDTnR0VXzL4ltPIECg3//9e7dSK/091Y8ivgPfC+92JsAdmziRAJxKYBAfWleZDYTOEwRP3vvIkpYnIWtelk0XgAaIiQGux0QvLO+BmsC48smL8IJOAD08eHLXDheZICLLyLRe9QYyQ6pfkmDAQRLjZVQbebIHdG+g7j6WuS6fJ5VnhmqC2TtHb1Zv7Mmm7bfKv953GQOLD1RT8KMkJIECW5MQA/M9UA3grvL2eO3vRGeonAMBG3r79m3+6nNCHlKyzxMGosAGECgL1yQYNYn0NAkwIxO1B06v/Vr5wjiIxxz27IIjd+Fwrvpa9vrH9TpTQJIECtck8nFPfLUXxj3A8wnxUMVPVl7+IaFwP7fOkpyfJs82Xz596kS0CBamgfMukemeqCYkAb6GCMyhMDLHwiGW382s+ePKU2DGypICeLq4uMDJtf+4vs2dCIVqYpxEXVYdjpOIyEYwUOzFRuZpYAwMnF7zOcxUvrJno69fvx73Qtu27nH7mDtggQXVBISayCiJMPQDUEIBssDAiMsgRhIMlQfCLkxWPuQdkEC4C2ScIWOM2xvoz/ObTe48EptgCBcTJxIpKSAeCYQQyHtPzruePQDh02RSJGzxScWxih0YujG74OnZb7+l4ZSsmq2cda7WbCBQD6icoXIem2GEXnyK1QAGJG00NaqhZ89UeqFeBPVChefqefz111878EAYx4bFRK14rXQRXeGFWzaQgF6+fJmVjEjR9G9SPowhwgeeSqb0QxyJD3xNNSL8WVKr6besy8tL8GLi0ECKIvy44kV0RVtZiuSUM0reYbe897dOhAMVZrFlXkzMJJMOlw4iac3iFYs/Ma6urgDZbDxMLuGTSgtD4T1gz2JAOWWUvHB/+vipSyKYkfyIx6m4aiYFBtYqOu+p4eovPXT9+def3eFuFRKOKuzar7P2ls7Pz1E93D3gx/fvu9ayICcJFK7zQw517pHiQQJGm37Nq4Xjb/w7Pmn8Ii4FZtizq8yobHYG2n/aeH+7yWkQGB1QYvHT84oI40ZsdEN9wy4cm+0GUmpHfSDibAsDh8IJJlkSeP78eVT/tMWAiIwWaDH7kYGyfF6oxQa2my20XTXAKOJiWMTGiQEV+x74yKdPERWLuMqmzrHMK/vxQ8tYUyJdOOTg2HXd2ACLMxHGnMZsC9ceuIt3fQ/0Ys2hSCCvrTTlHjJHDYQGRtdLD+jDa1GVQaoOqlxgrZV7+5+NMWQQeow+M57vzWlr6YUkvvqwsimmWlkDjLAXeThkHjSQa1wRHmr1ZO7kpePNGzsl9vAaD58p780LCzQCNd6Wn2MxUzjItWJwmDdGCuaMijGazf0mRxEu0JUnDTRioHzJwTIqc0S6kpeOsYEomDJlrKkGBmjnejYBSKMfGKqBAU1J3MhtzWazyevLVUYdKAziw4wBYAOggLTS4yVkTRWmDd3EGyzzctoVkjOXcNd2Y+PCwfc/NwGER6nock14Pz87O8v7Z867d+/SLZ+Fgq7iQzNtQMR75Qs3wIZx4qSJFLEc1trUkuw2ucskTZtSOvq8CGo8kAJPDQDDkxYOzKHyDo2z4yc+IjpGLxwG8TCTgIiGJpDXgYDh+x1JhHwfHCJpCIPwYkIJh8HMnmFnpiwfo5wahnv1SvmJhptdQrrR45gbQwhFkDVGrp2ENZZcQDKAIujk5xvr+gbX3o+XjxhgRFowylYapo052Upt3wtL/5aBSA0b1s6f/rxhk9pQM/G8oQWjCtU4aSDYRN/6tyzEb75nODDqWQPW2bqbKHOcgJlL4NiAMW52SWgPZOH4HnWwBJtxMuX6uUI1GhNirl5fZSi70PIEXDt5vbyBZoKQyYeWPLTkQiIHiWyIk/doCIzJQsl/zUkDALLLzBgwOH3dp8nr5c0zE2BHELpiIlQTU/cYwDkDAnXSwPX1NYKfMxAXJ+AcTi4f4wNZG8TETAKzu1NcYkDQ/OuPP9KkARtnEmgXN6Q2rjfhQjuTQCQdBhPWlHfsunQWGVArtdKTlf5KAs4G2UqX7iizCZhdAsbQL+qXropfaqCOb0rAWSRt7PSDy+OxgdkEqviFS2i5gWBnmtW3jK4AOkLI0ry7XUg+szgB2evP1TlOavtRA9a5aQPQMrqCkXgG89Q9fjoBhnHMzfcaiAeRuaOqXVzgdAIdORdmH1xGu0UJvFKjc1lcamBx4832hv/2o4TW5uQ9SwxEhvtRAy/PXualYs7OVD5TKg8HSc+IC77b1SaeNkEnUf+AG12XOalGlZcMWoDDfd0NoCdY9BD7L6RksZBVcSCPAAAAAElFTkSuQmCC";function us({onRun:S,appearance:r,platform:t}){const[f,u]=ot.useState(!1),n=()=>u(i=>!i),s=he("Mac-CDROMs",`Mac-CDROMs-${r}`,{"Mac-CDROMs-Expanded":f});return H.jsxs("div",{className:s,children:[H.jsx("div",{className:"Mac-CDROMs-Title",onClick:n,children:"CD-ROMs"}),f&&H.jsx(hs,{onRun:i=>{u(!1),S(i)},appearance:r,platform:t})]})}function hs({onRun:S,appearance:r,platform:t="Macintosh"}){const[f,u]=ot.useState(""),n=Qi,s=Array.from(Object.keys(n)).sort(),i={};let o;for(const c of s){if(f&&!c.toLowerCase().includes(f.toLowerCase()))continue;const g=n[c],{platform:l="Macintosh"}=g;if(l!==t)continue;const p=c.substring(0,c.length-g.name.length-1);p!==o&&(i[p]=[],o=p),i[p].push(g)}const h=Object.keys(i).sort((c,g)=>c===g?0:c.startsWith(g)?1:g.startsWith(c)?-1:c.localeCompare(g)),m=Object.fromEntries(h.map(c=>[c,i[c]]));for(const[c,g]of Object.entries(m))g.sort((l,p)=>l.name.localeCompare(p.name,void 0,{numeric:!0})),c==="System Software"&&g.sort(Xi);const[y,_]=ot.useState(!1);return H.jsxs("div",{className:"Mac-CDROMs-Contents",children:[y&&H.jsx(ds,{onRun:S,onDone:()=>_(!1),appearance:r}),H.jsxs("div",{className:"Mac-CDROMs-Header",children:[H.jsx("div",{className:"Mac-CDROMs-Instructions",children:"Load CD-ROM images into the emulated Mac to access software that is too large to pre-install on Infinite HD."}),H.jsx(ue,{appearance:r,onClick:()=>_(!0),children:"Load from URL…"}),H.jsx(bi,{appearance:r,type:"search",placeholder:"Filter…",value:f,onChange:c=>u(c.target.value)})]}),H.jsx("div",{className:"Mac-CDROMs-List",children:Object.entries(m).map(([c,g])=>H.jsxs("div",{className:"Mac-CDROMs-Category",children:[H.jsx("h3",{children:c}),H.jsx("div",{className:"Mac-CDROMs-Category-Contents",children:g.map(l=>H.jsx(fs,{cdrom:l,onRun:()=>{S(l)}},l.name))})]},c))})]})}function ds({onRun:S,onDone:r,appearance:t}){var i;const f=ot.useRef(null),[u,n]=ot.useState(""),s=async()=>{try{const o=await si(u);history.replaceState({},"",location.pathname+"?cdrom_url="+encodeURIComponent(u)),S(o),r()}catch(o){alert("Could not load CD-ROM: "+o.message)}};return H.jsxs(Lr,{title:"Run Custom CD-ROM…",onDone:s,doneLabel:"Run",doneEnabled:u!==""&&((i=f.current)==null?void 0:i.validity.valid),onCancel:r,appearance:t,children:[H.jsx("p",{children:"Infinite Mac supports loading of CD-ROM images from URLs. Be aware of the following caveats:"}),H.jsxs("ul",{children:[H.jsx("li",{children:"The CD-ROM image must be a raw .iso, .img, .toast or .bin file (i.e. not compressed, or a .dmg)"}),H.jsxs("li",{children:["Only a subset of sites are supported (currently archive.org, macintoshgarden.org and macintoshrepository.org). If there is another site that you wish to be supported, please contact the maintainer. Be aware that the HTTP server that serves the image has to support"," ",H.jsx("a",{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Range_requests",children:"range requests"})," ","so that the image can be streamed in."]})]}),H.jsx("p",{children:H.jsx(bi,{appearance:t,className:"Mac-Custom-CDROM-URL",type:"url",value:u,placeholder:"URL",size:40,onChange:o=>n(o.target.value),onKeyDown:o=>{var h;o.key==="Enter"&&((h=f.current)!=null&&h.validity.valid)&&s()},ref:f})})]})}function fs({cdrom:S,onRun:r}){const{name:t,coverImageHash:f,coverImageSize:u,coverImageType:n="round"}=S;let s,i,o,h;if(f&&u)i=`/Covers/${f}.jpeg`,[o,h]=u,s=he("Mac-CDROM-Cover",{"Mac-CDROM-Cover-Round":n==="round"});else{const m=S.platform==="NeXT";i=m?cs:ls,o=m?48:32,h=m?48:32,s=he("Mac-CDROM-Cover","Default")}return H.jsxs("div",{className:"Mac-CDROM",onClick:r,children:[H.jsx("img",{className:s,src:i,width:o,height:h,loading:"lazy"}),H.jsx("div",{className:"Mac-CDROM-Name",children:t})]})}function ps({emulatorType:S,emulatorSettings:r,appearance:t,setEmulatorSettings:f,onStorageReset:u,onStorageExport:n,onStorageImport:s,onSaveImage:i,hasSavedHD:o,onDone:h}){const[m,y]=ot.useState("unknown"),_={unknown:"Unknown",persistent:"Persistent",transient:"Transient",error:H.jsx("div",{style:{color:"#ff9999"},children:"error"})}[m],c=ot.useCallback(j=>{j.then(z=>y(z?"persistent":"transient")).catch(z=>{console.error("Could not use storage persistence API",z),y("error")})},[]);ot.useEffect(()=>{c(navigator.storage.persisted())},[c]);const g=ot.useCallback(()=>{c(navigator.storage.persist())},[c]),[l,p]=ot.useState(!1),[d,k]=ot.useState(!1),[C,x]=ot.useState(!1),[D,L]=ot.useState(!1),{screenScaling:T="auto"}=r;return H.jsxs(Lr,{title:"Settings",onDone:h,appearance:t,children:[H.jsxs("label",{children:[H.jsx(ui,{appearance:t,checked:r.swapControlAndCommand,onChange:()=>f({...r,swapControlAndCommand:!r.swapControlAndCommand})}),"Swap Control and Command Keys",H.jsx("div",{className:"Dialog-Description",children:"Makes it easier to use shortcuts like Command-W, Command-Q or Command-Shift-3 (which are otherwise handled by the host browser or OS)."})]}),vi(S)&&!r.trackpadMode&&H.jsxs("label",{children:[H.jsx(ui,{appearance:t,checked:r.useMouseDeltas,onChange:()=>f({...r,useMouseDeltas:!r.useMouseDeltas})}),"Use relative mouse movements",H.jsx("div",{className:"Dialog-Description",children:"Send relative mouse movements to the emulator instead of absolute positions. This can help with compatibility of games such as Apeiron."})]}),qi(S)&&H.jsxs("label",{children:["Speed:",H.jsx(hi,{appearance:t,value:r.speed,onChange:j=>f({...r,speed:parseInt(j.target.value)}),children:Array.from(Ji.entries(),([j,z])=>H.jsx("option",{value:j,children:z},`speed-${j}`))}),H.jsx("div",{className:"Dialog-Description",children:"Very old software may be timing dependent and thus only work at 1x speeds."})]}),H.jsxs("div",{className:"MacSettings-Row",children:[H.jsx("div",{className:"MacSettings-Row-Label",children:"Scaling:"}),H.jsxs(hi,{appearance:t,value:T,onChange:j=>{const z=j.target.value;f({...r,screenScaling:z})},children:[H.jsx("option",{value:"auto",children:"Auto"}),H.jsx("option",{value:"smooth",children:"Smooth"}),H.jsx("option",{value:"pixelated",children:"Crisp"})]}),H.jsx("div",{className:"Dialog-Description",children:"Preferred scaling method when displaying the Mac screen at non-native sizes."})]}),o&&H.jsxs(H.Fragment,{children:[H.jsx("h2",{children:"Saved HD"}),H.jsxs("div",{className:"MacSettings-Row",children:[H.jsx("div",{className:"MacSettings-Row-Label",children:"Contents:"}),H.jsx(ue,{appearance:t,onClick:()=>k(!0),children:"Export…"}),H.jsx(Er,{appearance:t,visible:d,setVisible:k,title:"Export Disk",body:"Exporting the contents of Saved HD requires that the Mac be shut down. The export will take a little while to generate, and will be downloaded as a .infinitemacdisk file. Are you sure you want to export?",onAccept:()=>{n(),h()}})," ",H.jsx(ue,{appearance:t,onClick:()=>x(!0),children:"Import…"}),H.jsx(Er,{appearance:t,visible:C,setVisible:x,title:"Import Disk",body:"Importing a previously exported .infinitemacdisk file HD will overwrite the existing Saved HD contents and requires that the Mac be shut down. Are you sure you want to import?",onAccept:()=>{s(),h()}})," ",H.jsx(ue,{appearance:t,onClick:()=>p(!0),children:"Reset"}),H.jsx(Er,{appearance:t,visible:l,setVisible:p,title:"Reset Disk",body:"Are you sure you want to reset the contents of Saved HD? The contents be removed and the Mac will be restarted.",onAccept:()=>{u(),h()}}),H.jsx("div",{className:"Dialog-Description",children:"The contents of Saved HD as persisted across page loads and between emulator instances in this browser. You can import/export it to have backups and to move it from one browser to another."})]}),H.jsxs("div",{className:"MacSettings-Row",children:[H.jsx("div",{className:"MacSettings-Row-Label"}),H.jsx(ue,{appearance:t,onClick:()=>L(!0),children:"Save Disk Image…"}),H.jsx(Er,{appearance:t,visible:D,setVisible:L,title:"Save Image",body:"Saving a disk image requires that the Mac be shut down. It will take a little while to generate, and will be downloaded as a .dsk or .hda file. Generate the disk image now?",onAccept:()=>{i(),h()},otherLabel:"Save Device Image (.hda)",onOther:()=>{i(!0),h()}}),H.jsxs("div",{className:"Dialog-Description",children:["You can also save the contents of Saved HD as a",H.jsx("code",{children:".dsk"})," or ",H.jsx("code",{children:".hda"})," file that can be loaded into other emulators."]})]}),H.jsxs("div",{className:"MacSettings-Row",children:[H.jsx("div",{className:"MacSettings-Row-Label",children:"Persistence:"}),_,m!=="persistent"&&H.jsxs(H.Fragment,{children:[" ",H.jsx(ue,{appearance:t,onClick:g,children:"Request Persistence"})]}),H.jsxs("div",{className:"Dialog-Description",children:["Ensures that the browser will try to keep the Saved HD data even when running low on disk space (",H.jsx("a",{href:"https://web.dev/persistent-storage/",target:"_blank",children:"more info"}),")."]})]})]})]})}function Er({visible:S,setVisible:r,title:t,body:f,onAccept:u,onOther:n,otherLabel:s,appearance:i}){return S?H.jsx(Lr,{title:t,onDone:()=>{r(!1),u()},doneLabel:t,onOther:n,otherLabel:s,onCancel:()=>r(!1),appearance:i,children:H.jsx("div",{style:{maxWidth:400},children:f})}):null}function ai(S){return S.name+".data"}function Nr(S){return S.name+".dirtychunks"}const ms="/assets/Device%20Image%20Header%20(Apple%20SCSI%204.3%20Driver)-DqP3lu84.hda",ri=512,gs=2,_s=(gs+1)*ri;function ws(S,r,t){const f=S.byteLength;f!==933888&&console.warn("Expected base header to be 0xE4000 bytes, got 0x"+f.toString(16)+" bytes, results may be unpredictable");const u=S.slice(0),n=new DataView(u),i=(r+f)/ri;n.setInt32(4,i);const o=_s,h=r/ri;return n.setInt32(o+12,h),n.setInt32(o+84,h),u}async function ys(S){const r=(await S.generatedSpec()).default,t=await navigator.storage.getDirectory();try{t.removeEntry(Nr(r))}catch(f){if(f instanceof DOMException&&f.name==="NotFoundError")return;console.warn("Could not remove dirty chunks file",f)}}async function vs(S){const r=(await S.generatedSpec()).default,t=await navigator.storage.getDirectory(),f=Nr(r),u=await t.getFileHandle(f,{create:!0}),n=ai(r),s=await t.getFileHandle(n,{create:!0}),i=new wr;await i.file(f,u.getFile()),await i.file(n,s.getFile());const o=await i.generateAsync({compression:"DEFLATE",compressionOptions:{level:1},type:"blob"});xr.saveAs(o,r.name+".infinitemacdisk")}async function bs(S){const r=await ks(),t=(await S.generatedSpec()).default,f=Nr(t),u=ai(t),n=await wr.loadAsync(r),s=n.file(f);if(!s)throw new Error("Could not find dirty chunks file in import");const i=n.file(u);if(!i)throw new Error("Could not find data file in import");const o=await navigator.storage.getDirectory(),m=await(await o.getFileHandle(f,{create:!0})).createWritable();await m.write(await s.async("blob")),await m.close();const _=await(await o.getFileHandle(u,{create:!0})).createWritable();await _.write(await i.async("blob")),await _.close()}function ks(){return new Promise(S=>{const r=document.createElement("input");r.type="file",r.accept=".infinitemacdisk",r.onchange=()=>{r.files&&S(r.files[0]),r.remove()},r.click()})}async function Ss(S,r){const t=(await S.generatedSpec()).default,f=await navigator.storage.getDirectory(),u=Nr(t),s=await(await f.getFileHandle(u,{create:!0})).getFile(),i=new Uint8Array(await s.arrayBuffer()),o=ai(t),m=await(await f.getFileHandle(o,{create:!0})).getFile(),y=new Uint8Array(await m.arrayBuffer()),_=new Uint8Array(t.totalSize);_.set(y);const c={...t,baseUrl:"/Disk"};for(let g=0;g<t.chunks.length;g++){if(!t.chunks[g])continue;const p=g>>3,d=1<<(g&7);if(i[p]&d)continue;const k=$i(c,g),C=await(await fetch(k)).arrayBuffer();_.set(new Uint8Array(C),g*t.chunkSize)}if(r){const g=await(await fetch(ms)).arrayBuffer(),l=ws(g,t.totalSize);xr.saveAs(new Blob([l,_]),t.name+".hda");return}xr.saveAs(new Blob([_]),t.name+".dsk")}function Es({disks:S,includeInfiniteHD:r,includeSavedHD:t,diskFiles:f,cdroms:u,initialErrorText:n,machine:s,ramSize:i,screenSize:o,ethernetProvider:h,customDate:m,debugFallback:y,debugAudio:_,debugPaused:c,debugLog:g,debugTrackpad:l,onDone:p}){var vr;const d=ot.useRef(null),[k,C]=ot.useState(!1),[x,D]=ot.useState(void 0),[L,T]=ot.useState(!1),[j,z]=ot.useState([0,0]),[Y,rt]=ot.useState(1),[E,B]=ot.useState(!1),[a,N]=ot.useState(n),[nt,Z]=ot.useState([]),st=ot.useRef(0),U=ot.useRef(),it=ot.useRef(),O=ot.useCallback(()=>{var $;($=U.current)==null||$.refreshSettings()},[]),[R,et]=tn(Ds,"emulator-settings",O),Q=ot.useRef(R);Q.current=R;const X=s.fixedScreenSize??(typeof o=="object"?o:xs[o]),{width:gt,height:vt}=X,[lt,dt]=ot.useState(X),{width:wt,height:_t}=lt,At=t&&en();ot.useEffect(()=>{var Xt,br,xe;const $=[...S],ft=[];if(r){let ut;s.platform==="NeXT"?ut=on:((Xt=S[0])==null?void 0:Xt.infiniteHdSubset)==="mfs"||s.mfsOnly?ut=ln:((br=S[0])==null?void 0:br.infiniteHdSubset)==="system6"?ut=cn:ut=un,(xe=S[0])!=null&&xe.delayAdditionalDiskMount?ft.push(ut):$.push(ut)}At&&$.push(De);const kt=typeof SharedArrayBuffer<"u"&&!y,St=new rs({machine:s,ramSize:i,useSharedMemory:kt,screenWidth:gt,screenHeight:vt,screenCanvas:d.current,disks:$,diskFiles:f.map(ut=>({name:ut.file.name,url:URL.createObjectURL(ut.file),size:ut.file.size,isCDROM:ut.treatAsCDROM})),delayedDisks:ft,cdroms:u,ethernetProvider:h,customDate:m,debugAudio:_,debugLog:g,debugTrackpad:l},{emulatorDidExit(ut){p()},emulatorDidChangeScreenSize(ut,Ot){dt({width:ut,height:Ot})},emulatorDidFinishLoading(ut){C(!0),ut.refreshSettings()},emulatorDidMakeLoadingProgress(ut,Ot,jt){z([Ot,jt])},emulatorDidStartToLoadDiskChunk(ut){B(!0),clearTimeout(st.current)},emulatorDidFinishLoadingDiskChunk(ut){window.clearTimeout(st.current),st.current=window.setTimeout(()=>{B(!1)},200)},emulatorEthernetPeersDidChange(ut,Ot){h&&Z(Ot)},emulatorDidRunOutOfMemory(ut){Qt("emulator_error:out_of_memory"),N(`The emulator ran out of memory.

If you are running it in a mobile app's in-app browser, try switching to the native browser (Safari or Chrome) on your device.`)},emulatorDidHaveError(ut,Ot,jt){Ot.includes("load")&&Ot.includes("/CD-ROM")?kr("emulator_error:cdrom_chunk_load",jt):Ot.includes("saved disk")?Ot.includes("missing the necessary APIs")?kr("emulator_error:saved_disk_unsupported",jt):kr("emulator_error:saved_disk",jt):kr("emulator_error:other",jt),N(`The emulator encountered an error:

${Ot}`)},emulatorSettings(ut){return Q.current},emulatorDidMakeCDROMLoadingProgress(ut,Ot,jt){rt(jt)}});U.current=St,it.current=h,c||St.start();const Ct={emulator_starts:1,emulator_ethernet:h?1:0,[`emulator_type:${s.emulatorType}`]:1,emulator_shared_memory:kt?1:0};if(S.length===1){const ut=S[0];Ct[`emulator_disk:${ut.displayName}${ut.displaySubtitle?"-"+ut.displaySubtitle:""}`]=1}return Kr(Ct),()=>{var ut;St.stop(),U.current=void 0,(ut=h==null?void 0:h.close)==null||ut.call(h)}},[S,f,r,u,s,h,gt,vt,m,y,_,c,g,l,At,i,p]);const{appearance:Et="Classic"}=S[0]??{},e=()=>{var $,ft,kt,St;(ft=($=document.body).requestFullscreen)!=null&&ft.call($)||((St=(kt=document.body).webkitRequestFullscreen)==null||St.call(kt))},F=ot.useCallback(()=>{var ft,kt;const $=!!(document.fullscreenElement??document.webkitFullscreenElement);if(T($),$&&((kt=(ft=navigator.keyboard)==null?void 0:ft.lock)==null||kt.call(ft)),document.body.classList.toggle("fullscreen",$),$&&o!=="fullscreen"){const St=window.screen.availHeight/d.current.height,Ct=window.screen.availWidth/d.current.width;D(Math.min(St,Ct))}else D(void 0)},[o]);ot.useEffect(()=>(document.addEventListener("fullscreenchange",F),document.addEventListener("webkitfullscreenchange",F),()=>{document.removeEventListener("fullscreenchange",F),document.removeEventListener("webkitfullscreenchange",F)}),[F]);const[M,v]=ot.useState(!1),w=()=>{v(!0)},A=ot.useRef(null),P=()=>{const $=A.current;$&&($.style.visibility="visible",$.focus())},W=()=>{var $;($=U.current)==null||$.start()};let I;if(!k){const[$,ft]=j;$===0&&ft===0&&c?I=H.jsx("div",{className:"Mac-Loading",children:"Waiting for manual start…"}):I=H.jsxs("div",{className:"Mac-Loading",children:["Loading data files…",H.jsxs("span",{className:"Mac-Loading-Fraction",children:["(",$-ft,"/",$,")"]})]})}Y<1&&(I=H.jsxs("div",{className:he("Mac-Loading",{"Mac-Loading-Non-Modal":k}),children:["Loading CD-ROM…",H.jsxs("span",{className:"Mac-Loading-Fraction",children:[(Y*100).toFixed(0),"%"]})]}));function V($){$.preventDefault()}const[J,G]=ot.useState(0);function tt($){$.preventDefault()}function pt($){G(ft=>ft+1)}function ct($){G(ft=>ft-1)}function xt($){var St;$.preventDefault(),G(0);const ft=U.current;if(!ft)return;const kt=[];if($.dataTransfer.items)for(const Ct of $.dataTransfer.items){const Xt=(St=Ct.webkitGetAsEntry)==null?void 0:St.call(Ct);if(Xt!=null&&Xt.isDirectory){Cs(ft,Xt);return}Ct.kind==="file"?kt.push(Ct.getAsFile()):Ct.kind==="string"&&Ct.type==="text/uri-list"&&Ct.getAsString(async br=>{var xe;try{const ut=await si(br);Qt("emulator_cdrom:drag"),(xe=U.current)==null||xe.loadCDROM(ut)}catch(ut){console.log("error fetching cdrom",ut);return}})}else if($.dataTransfer.files)for(const Ct of $.dataTransfer.files)kt.push(Ct);ii(ft,kt)}function Yt(){const $=document.createElement("input");$.type="file",$.multiple=!0,$.onchange=()=>{G(1),$.files&&U.current&&ii(U.current,Array.from($.files)),$.remove(),setTimeout(()=>G(0),500)},$.click()}function Rt($){var ft;Kr({emulator_cdroms:1,[`emulator_cdrom:${$.name}`]:1}),(ft=U.current)==null||ft.loadCDROM($)}const Ut=window.innerWidth-wt;let mt="Large";Ut<As?mt="Small":Ut<ni&&(mt="Medium");const Ft=[{label:"‹ Home",handler:p,alwaysVisible:!0},{label:"Load File",handler:Yt},{label:"Full Screen",handler:e},{label:"Settings",handler:w}];if(_i){Ft.push({label:"Keyboard",handler:P});const $=yi(s.emulatorType)||R.useMouseDeltas;Ft.push({label:"Trackpad",handler:()=>{et({...R,trackpadMode:!R.trackpadMode})},selected:$||R.trackpadMode})}c&&!k&&Ft.splice(1,0,{label:"Start",handler:W,alwaysVisible:!0});const ce=os();let Dt;const{screenScaling:yr="auto"}=R;switch(yr){case"auto":Dt=o==="auto"&&(L||ce!==Math.floor(ce));break;case"pixelated":Dt=!1;break;case"smooth":Dt=!0;break}const Pr=he("Mac-Screen",{"Mac-Screen-Smooth-Scaling":Dt});return H.jsxs(H.Fragment,{children:[H.jsxs(rn,{className:"Mac",bezelStyle:s.bezelStyle,viewTransitionName:S.length?nn(S[0]):void 0,bezelSize:mt,width:wt,height:_t,scale:x,fullscreen:L||o==="fullscreen"||o==="window",led:!k&&!c||E?"Loading":"On",onDragStart:V,onDragOver:tt,onDragEnter:pt,onDragLeave:ct,onDrop:xt,controls:Ft,screen:H.jsxs(H.Fragment,{children:[H.jsx("canvas",{className:Pr,ref:d,width:wt,height:_t,onContextMenu:$=>$.preventDefault()}),_i&&H.jsx("input",{type:"text",className:"Mac-Keyboard-Input",ref:A})]}),children:[I,J>0&&H.jsx("div",{className:he("Mac-Overlay","Mac-Drag-Overlay",{"Mac-Drag-Overlay-Downloads":sn(s.emulatorType)})}),it.current&&H.jsx(Is,{provider:it.current,peers:nt}),M&&H.jsx(ps,{emulatorType:s.emulatorType,emulatorSettings:R,appearance:Et,setEmulatorSettings:et,hasSavedHD:At,onStorageReset:()=>{var $;Qt("emulator_disk_saver_reset"),($=U.current)==null||$.restart(()=>ys(De))},onStorageExport:()=>{var $;($=U.current)==null||$.restart(()=>vs(De)),Qt("emulator_disk_saver_export")},onStorageImport:()=>{var $;($=U.current)==null||$.restart(()=>bs(De)),Qt("emulator_disk_saver_import")},onSaveImage:$=>{var ft;(ft=U.current)==null||ft.restart(()=>Ss(De,$)),Qt("emulator_disk_saver_save_image")},onDone:()=>v(!1)}),a&&H.jsx(Rs,{appearance:Et,text:a,onDone:()=>N("")})]}),!L&&((vr=S[0])==null?void 0:vr.infiniteHdSubset)!=="mfs"&&H.jsx(us,{onRun:Rt,appearance:Et,platform:s.platform})]})}function Cs(S,r){let t=1;const f=[],u=[],n=(o,h)=>{f.push(o),u.push(h.join("/")),s()},s=()=>{t--,t===0&&ii(S,f,u)},i=(o,h)=>{o.createReader().readEntries(y=>{t--,y.forEach(_=>{if(t++,_.isDirectory){i(_,[...h,_.name]);return}_.file(g=>n(g,[...h,_.name])),t++,o.getFile(`${_.name}/..namedfork/rsrc`,{},g=>g.file(l=>n(l,[...h,".rsrc",_.name]),s),s)})})};i(r,[r.name])}function ii(S,r,t=[]){let f=0,u=0;for(const s of r)an(s.name)?u++:f++;const n=t.filter(s=>s.includes("/.rsrc/")).length;S.uploadFiles(r,t),Kr({emulator_uploads:r.length,"emulator_uploads:files":f,"emulator_uploads:disks":u,"emulator_uploads:resource_forks":n})}const As=80,ni=168,xs={auto:(()=>{const S=window.innerWidth-ni,r=window.innerHeight-ni;for(const[t,f]of[[1600,1200],[1280,1024],[1152,870],[1024,768],[800,600],[640,480]])if(t<=S&&f<=r)return{width:t,height:f};return{width:640,height:480}})(),window:{width:window.innerWidth,height:window.innerHeight},fullscreen:{width:window.screen.width,height:window.screen.availHeight}},_i="matchMedia"in window&&!window.matchMedia("(hover: hover)").matches,Ds={swapControlAndCommand:!1,speed:-2,useMouseDeltas:!1,trackpadMode:!1};function Is({provider:S,peers:r}){let t=`Ethernet: ${S.description()}`;const f=r.filter(i=>Date.now()-i.lastPingTimeMs<6e4).length;f&&(t+=` (${f} peer${f===1?"":"s"})`);const[u,n]=ot.useState(!!new URLSearchParams(location.search).get("ethernet_status"));let s;if(u){let i;r.length&&(i=H.jsxs("div",{className:"Mac-Ethernet-Status-Peers",children:[H.jsx("b",{children:"Peers:"}),H.jsx("ul",{children:r.map(o=>{const h=Date.now()-o.lastPingTimeMs;let m;return h>3e4&&(m=` ${(h/1e3).toFixed(0)}s ago`),H.jsxs("li",{children:[o.macAddress," (RTT:"," ",o.rttMs.toFixed(0),"ms",m,")"]},o.macAddress)})})]})),s=H.jsxs("div",{className:"Mac-Ethernet-Status-Details",children:[H.jsx("b",{children:"MAC Address:"})," ",S.macAddress(),i]})}return H.jsxs("div",{className:"Mac-Ethernet-Status",onClick:()=>n(!u),children:[H.jsx("div",{className:"ScreenFrame-Bezel-Text",children:t}),s]})}function Rs({appearance:S,text:r,onDone:t}){return H.jsx(Lr,{appearance:S,title:"Emulator Error",onDone:t,doneLabel:"Bummer",children:H.jsx("p",{style:{whiteSpace:"pre-line"},children:r})})}function zs({runDef:S,onDone:r}){const[t,f]=ot.useState(S.cdromURLs.length?void 0:[]),[u,n]=ot.useState(void 0);return ot.useEffect(()=>{S.cdromURLs.length&&Promise.all(S.cdromURLs.map(si)).then(f).catch(s=>{n(`Could not load the CD-ROM: ${s}`),f([])})},[S.cdromURLs]),S.disks.forEach(s=>s.generatedSpec()),t?H.jsx(Es,{disks:S.disks,includeInfiniteHD:S.includeInfiniteHD,includeSavedHD:S.includeSavedHD,diskFiles:S.diskFiles,cdroms:t,initialErrorText:u,machine:S.machine,ramSize:S.ramSize,screenSize:S.screenSize,ethernetProvider:S.ethernetProvider,customDate:S.customDate,debugFallback:S.debugFallback,debugAudio:S.debugAudio,debugPaused:S.debugPaused,debugLog:S.debugLog,debugTrackpad:S.debugTrackpad,onDone:r}):H.jsx("div",{style:{color:"#aaa"},children:"Loading CD-ROM Metadata…"})}export{zs as default};
